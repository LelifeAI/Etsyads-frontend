<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>LeLife-Etsyads-AI</title>

    <!-- Ch√®n CSS t·ª´ th∆∞ m·ª•c static -->
	<link rel="stylesheet" href="static/style.css">
        <script src="/static/js/script.js"></script>

    <style>
   

  body {
        	font-family: 'Arial', sans-serif;
       	 	background-color: #f4f4f9;
        	margin: 0;
        	padding: 0;
                padding-top: 110px; /* ƒê·∫©y n·ªôi dung xu·ªëng ƒë·ªÉ kh√¥ng b·ªã che b·ªüi header */
		font-size: 16px; /* C·ª° ch·ªØ c∆° b·∫£n */
   		line-height: 1.5; /* D√≤ng ch·ªØ tho√°ng h∆°n */

    }

h1, h2 {
    margin-top: 25px; /* T·∫°o kho·∫£ng c√°ch ph√≠a tr√™n ti√™u ƒë·ªÅ */
    margin-bottom: 10px; /* Kho·∫£ng c√°ch ph√≠a d∆∞·ªõi ti√™u ƒë·ªÅ */
}


html, body {
    max-width: 100%; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông */
    overflow-x: hidden; /* NgƒÉn cu·ªôn ngang */
}
  
   
/* Ch·ªânh l·∫°i container ƒë·ªÉ t·ª± co gi√£n */
.container {
    max-width: 100%;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
}


        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: black;
            color: white;
            padding: 0px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }

        .logo img {
            height: 50px;
        }

/* ƒê·∫£m b·∫£o n·ªôi dung ch√≠nh kh√¥ng che menu */
	.input-section,
	.result-section,
	.chart-section {
  	  position: relative;
 	   z-index: 1;
}

/* CƒÉn ch·ªânh c√°c th·∫ª div v√† section b√™n trong */
.input-section, .result-section, .chart-section, .threshold-section {
    margin-bottom: 10px;
    padding: 10px;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box; /* ƒê·∫£m b·∫£o padding kh√¥ng l√†m thay ƒë·ªïi k√≠ch th∆∞·ªõc ph·∫ßn t·ª≠ */
}
        
.flex-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
}
       
 .section-header {
    	 	font-size: 1.2rem; /* K√≠ch th∆∞·ªõc ch·ªØ */
    		font-weight: bold; /* In ƒë·∫≠m ch·ªØ */
   	 	color: #000 !important; /* ƒê·ªïi m√†u ch·ªØ sang ƒëen v√† ∆∞u ti√™n √°p d·ª•ng */
    		margin-bottom: 5px; /* Kho·∫£ng c√°ch d∆∞·ªõi */
   	 	text-align: center; /* CƒÉn gi·ªØa vƒÉn b·∫£n */
		z-index: 1; /* ƒê·∫£m b·∫£o kh√¥ng ch·ªìng l·∫•n l√™n dropdown */
	        position: relative; /* Gi·ªØ header n·∫±m trong container */
}

        
label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }

        input[type="text"], input[type="number"], input[type="date"] {
    width: calc(100% - 20px);
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 16px;
}

/* Ch·ªânh ph·∫ßn n√∫t b·∫•m */
.button {
    background-color: #4caf50;
    color: white;
    padding: 12px 20px;
    margin-top: 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    margin-left: 10px; /* Th√™m kho·∫£ng c√°ch v·ªõi c·∫°nh tr√°i */
}

        .button:hover {
            background-color: #45a049;
        }
        .results, .proposals {
            padding: 15px;
            background-color: #f1f1f1;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .chart-container {
		text-align: center;
    		margin-top: 30px;        
}

        .chart {
            width: 100%;
            max-width: 500px;
            margin: auto;
        }
        .row {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 20px;
	    padding-left: 20px; /* Th√™m padding v√†o b√™n tr√°i */
            padding-right: 20px; /* Th√™m padding v√†o b√™n ph·∫£i */
        }
        .row label {
            flex: 1;
            margin-right: 10px; /* Th√™m kho·∫£ng c√°ch gi·ªØa label v√† input */
        }
        .row input {
            flex: 2;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 100%;;
        }

.row div {
    margin-bottom: 0px;
    padding: 10px;
}

.row div label {
    display: block;
    font-weight: bold;
    margin-bottom: 0px;
}


/* CƒÉn ch·ªânh c√°c ph·∫ßn nh·∫≠p d·ªØ li·ªáu */
.threshold-inputs {
   display: flex;
    justify-content: space-between;
    gap: 15px;
    margin-top: 20px;
    padding-left: 20px;
    padding-right: 20px;
}
.chart-section {
    margin-top: 20px;
    text-align: center;
}

.section-header {
    font-size: 1.5rem;
    color: #4CAF50;
    margin-bottom: 5px;
}

body {
    font-family: Arial, sans-serif;
    background-color: #f3f4f6;
    color: #333;
}

img {
    max-width: 100%;
    height: auto;
    display: block; /* Lo·∫°i b·ªè kho·∫£ng tr·∫Øng d∆∞·ªõi h√¨nh ·∫£nh */
}

.header-container {
    display: flex;
    align-items: center;
    justify-content: space-between; /* Gi·ªØ menu b√™n ph·∫£i */
    padding: 10px 20px;
    background-color: black; /* M√†u n·ªÅn */
}

header {
    position: fixed; /* C·ªë ƒë·ªãnh header tr√™n c√πng */
    top: 0; /* ƒê·∫∑t ·ªü v·ªã tr√≠ ƒë·∫ßu trang */
    left: 0; /* CƒÉn tr√°i */
    width: 100%; /* Chi·∫øm to√†n b·ªô chi·ªÅu ngang */
    z-index: 1000; /* ƒê·∫£m b·∫£o header hi·ªÉn th·ªã tr√™n m·ªçi ph·∫ßn t·ª≠ kh√°c */
    background-color: black; /* M√†u n·ªÅn */
    color: white; /* M√†u ch·ªØ */
    padding: 5px 15px; /* T·∫°o kho·∫£ng c√°ch b√™n trong */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* T·∫°o hi·ªáu ·ª©ng ƒë·ªï b√≥ng */
    justify-content: space-between; /* CƒÉn ƒë·ªÅu kho·∫£ng c√°ch gi·ªØa c√°c n√∫t */
    align-items: center;

}

@keyframes moveLogo {
    0% { transform: translateX(0); } /* V·ªã tr√≠ ban ƒë·∫ßu */
    50% { transform: translateX(20px); } /* D·ªãch sang ph·∫£i */
    100% { transform: translateX(0); } /* Quay l·∫°i ban ƒë·∫ßu */
}

.logo img {
        height: 80px;
	animation: moveLogo 3s infinite ease-in-out; /* L·∫∑p v√¥ h·∫°n */

}

/* Header */
header h1 {
    text-align: center;
    padding: 10px;
    background-color: #333;
    color: white;
    margin: 0;
    font-size: 24px;
}


.input-section {
    display: flex; /* S·ª≠ d·ª•ng flex ƒë·ªÉ cƒÉn ch·ªânh n·ªôi dung */
    justify-content: center; /* CƒÉn gi·ªØa n·ªôi dung theo chi·ªÅu ngang */
    align-items: center; /* CƒÉn gi·ªØa n·ªôi dung theo chi·ªÅu d·ªçc */
    margin: 10px auto; /* Gi·∫£m kho·∫£ng c√°ch ngo√†i ƒë·ªÉ khung g·ªçn h∆°n */
    padding: 5px 15px; /* Gi·∫£m padding ƒë·ªÉ ph√π h·ª£p v·ªõi n·ªôi dung */
    max-width: fit-content; /* ƒê·∫£m b·∫£o khung v·ª´a v·ªõi n·ªôi dung */
    background-color: #f9f9f9; /* M√†u n·ªÅn */
    border-radius: 8px; /* Bo g√≥c */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* T·∫°o ƒë·ªï b√≥ng */
    text-align: center; /* CƒÉn gi·ªØa vƒÉn b·∫£n */
    font-size: 1.2rem; /* C·ª° ch·ªØ ph√π h·ª£p */
    font-weight: bold; /* In ƒë·∫≠m vƒÉn b·∫£n */
    color: #4CAF50; /* M√†u ch·ªØ */
    box-sizing: border-box; /* ƒê·∫£m b·∫£o padding kh√¥ng l√†m thay ƒë·ªïi k√≠ch th∆∞·ªõc */
}


.input-section, .result-section, .chart-section {
    margin-bottom: 30px;
}

.button {
    background-color: #4caf50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
}

.button:hover {
    background-color: #45a049;
}

.results, .proposals {
    background-color: #f9f9f9;
    border-radius: 8px;
    padding: 15px;
    margin-top: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.chart-container {
    text-align: center;
    margin-top: 20px;
}

.flex-container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    gap: 20px;
}


input[type="number"], input[type="text"] {
    padding: 10px;
    border-radius: 5px;
    border: 1px solid #ccc;
    width: calc(100% - 24px);
    margin-bottom: 10px;
    font-size: 16px;
}

.notification {
    background-color: #4caf50;
    color: white;
    padding: 15px;
    border-radius: 5px;
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}

#change-password-form {
    display: none;
}

#show-change-password-btn {
    display: block;
}

.show-form #change-password-form {
    display: block;
}


.content-section {
        margin: 20px;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    .button {
        background-color: #4CAF50;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .button:hover {
        background-color: #45a049;
    }

/* ƒê·∫∑t menu ·ªü ch√≠nh gi·ªØa trang */
nav {
    position: absolute; /* Cho ph√©p ƒëi·ªÅu ch·ªânh v·ªã tr√≠ b·∫±ng top v√† left */
    top: 50%; /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
    left: 50%; /* CƒÉn gi·ªØa theo chi·ªÅu ngang */
    transform: translate(-50%, -50%); /* ƒêi·ªÅu ch·ªânh t√¢m v·ªÅ ch√≠nh gi·ªØa */
}

/* V·ªã tr√≠ n√∫t Demos */
/* Ch·ªânh k√≠ch th∆∞·ªõc v√† cƒÉn ch·ªânh menu dropdown */
/* CƒÉn gi·ªØa v√† c·ªë ƒë·ªãnh v·ªã tr√≠ c√°c n√∫t trong menu */
.nav-bar {
    display: flex;
    flex-wrap: nowrap;
    justify-content: flex-end; /* Gi·ªØ c√°c n√∫t v·ªÅ b√™n ph·∫£i */
    align-items: center;
    list-style: none;
    padding: 0;
    white-space: nowrap;
    overflow: hidden;
    color: white;
    gap: 0px; /* ƒêang l√† 0px */
    padding-right: 0px; /* ƒêi·ªÅu ch·ªânh n·∫øu mu·ªën d·ªãch ph·∫£i */
    margin-left: 10px; /* D·ªãch sang ph·∫£i */
}

/* Ch·ªânh kho·∫£ng c√°ch gi·ªØa Lelife v√† Demos */
.nav-bar li {
    margin: 0 5px; /* Kho·∫£ng c√°ch gi·ªØa c√°c n√∫t */
    flex-shrink: 1; /* Cho ph√©p c√°c n√∫t co gi√£n khi kh√¥ng ƒë·ªß kh√¥ng gian */
    list-style: none;
    display: inline-block;
}

.nav-bar li:nth-child(3) { /* √Åp d·ª•ng cho m·ª•c T√†i Li·ªáu */
    margin-left: 20px;
}

.nav-bar a {
    display: inline-block;
    text-decoration: none; /* B·ªè g·∫°ch ch√¢n */
    font-size: 0.5rem; /* C·ª° ch·ªØ m·∫∑c ƒë·ªãnh */
    color: white; /* M√†u ch·ªØ */
    padding: 8px 12px; /* Kho·∫£ng c√°ch b√™n trong n√∫t */
    white-space: nowrap; /* NgƒÉn ch·ªØ ng·∫Øt d√≤ng */
    border-radius: 5px; /* Bo g√≥c n√∫t */
    background-color: #4CAF50; /* M√†u n·ªÅn n√∫t */
    text-align: center;
    flex-shrink: 1; /* Thu nh·ªè n√∫t n·∫øu kh√¥ng ƒë·ªß kh√¥ng gian */
    min-width: 100px; /* Chi·ªÅu r·ªông t·ªëi thi·ªÉu c·ªßa n√∫t */
    max-width: 110px; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông t·ªëi ƒëa */
    overflow: visible; /* NgƒÉn ch·ªØ tr√†n ra ngo√†i */
    text-overflow: clip; /* Th√™m d·∫•u "..." n·∫øu ch·ªØ qu√° d√†i */
    margin: 0 1px; /* Gi·∫£m kho·∫£ng c√°ch gi·ªØa c√°c button */
    box-sizing: border-box; /* ƒê·∫£m b·∫£o padding kh√¥ng l√†m tƒÉng k√≠ch th∆∞·ªõc button */

}

.nav-bar a:hover {
    background-color: #45a049; /* M√†u khi r√™ chu·ªôt v√†o */
}

.nav-bar li:nth-child(2) { /* √Åp d·ª•ng cho n√∫t Demos */
    margin-left: 20px; /* TƒÉng kho·∫£ng c√°ch b√™n tr√°i */
}

img {
    max-width: 100%;
    height: auto;
    display: block; /* Lo·∫°i b·ªè kho·∫£ng tr·∫Øng d∆∞·ªõi h√¨nh ·∫£nh */
}

html, body {
    max-width: 100%; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông */
    overflow-x: hidden; /* NgƒÉn cu·ªôn ngang */
    transform: scale(1);
    transform-origin: top left;
}

/* Responsive: T·ªëi ∆∞u kho·∫£ng c√°ch tr√™n m√†n h√¨nh nh·ªè */
/* Responsive adjustments */
@media (max-width: 768px) {

.dropdown-menu {
        flex-direction: column; /* Hi·ªÉn th·ªã c√°c button theo chi·ªÅu d·ªçc */
	position: static; /* Hi·ªÉn th·ªã menu d∆∞·ªõi button */
        box-shadow: none; /* Lo·∫°i b·ªè ƒë·ªï b√≥ng */
        border: none; /* Lo·∫°i b·ªè vi·ªÅn */
	min-width: 160px; /* ƒê·ªô r·ªông t·ªëi thi·ªÉu ƒë·ªÉ ch·ªØ kh√¥ng b·ªã c·∫Øt */
    }

nav-bar {
        flex-direction: row; /* Hi·ªÉn th·ªã c√°c button theo chi·ªÅu d·ªçc */
        align-items: flex-start; /* CƒÉn tr√°i c√°c button */
        padding: 10px; /* Gi·∫£m padding */
        gap: 5px; /* Gi·∫£m kho·∫£ng c√°ch gi·ªØa c√°c button */
    }

    .nav-bar a {
        font-size: 0.9rem; /* Gi·∫£m c·ª° ch·ªØ */
        padding: 6px 10px; /* Gi·∫£m padding */
	width: 90%; /* Button chi·∫øm to√†n b·ªô chi·ªÅu r·ªông */
        min-width: 100px; /* Gi·∫£m chi·ªÅu r·ªông t·ªëi thi·ªÉu n·∫øu c·∫ßn */
        margin: 5px 0; /* Kho·∫£ng c√°ch gi·ªØa c√°c button */
        text-align: left; /* CƒÉn tr√°i ch·ªØ trong button */
	flex-shrink: 0; /* NgƒÉn button b·ªã thu nh·ªè qu√° m·ª©c */
    }
}

@media (max-width: 480px) {
    .nav-bar a {
        font-size: 0.8rem; /* Ti·∫øp t·ª•c gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
        padding: 5px 10px; /* Gi·∫£m th√™m padding */
    }
}

/* Responsive cho m√†n h√¨nh nh·ªè */
@media screen and (max-width: 768px) {
    .container {
        padding: 10px;
    }

    /* Ch·ªânh font ch·ªØ nh·ªè h∆°n tr√™n ƒëi·ªán tho·∫°i */
    th, td {
        font-size: 12px;
        padding: 5px;
    }

    /* Cho ph√©p b·∫£ng cu·ªôn ngang tr√™n ƒëi·ªán tho·∫°i */
    table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
    }

    /* ƒê·ªãnh d·∫°ng l·∫°i n√∫t */
    .button {
        font-size: 14px;
        padding: 8px;
        width: 100%;
    }
}

/* Responsive cho m√†n h√¨nh r·∫•t nh·ªè (<480px) */
@media screen and (max-width: 480px) {
    th, td {
        font-size: 11px;
        padding: 4px;
    }
}

.auth-links a {
    color: white;
    font-weight: bold;
    margin-left: 1050px;
}

.auth-links a:hover {
    color: #4CAF50;
}

/* N√∫t Demos */
.nav-bar li a {
    display: block;
    color: #333; /* M√†u ch·ªØ t·ªëi */
    background-color: #f7f7f7;
    text-align: center;
    padding: 12px 14px;
    border-radius: 5px;
    text-decoration: none;
    font-size: 16px;
    font-weight: bold;

}

.nav-bar li a:hover {
    color: #000; /* M√†u ch·ªØ khi r√™ chu·ªôt v√†o */
    background-color: #575757; /* M√†u n·ªÅn khi r√™ chu·ªôt */}

/* CƒÉn ch·ªânh n√∫t ƒêƒÉng nh·∫≠p/ƒêƒÉng k√Ω */
.auth-buttons {
    margin-left: auto;
    display: flex;
    gap: 10px;
}

.auth-buttons a {
    background-color: #4caf50;
    color: white;
    padding: 8px 12px;
    text-decoration: none;
    border-radius: 5px;
    font-size: 14px;
    transition: background-color 0.3s ease;
}

.auth-buttons a:hover {
    background-color: #45a049;
}


/* Hi·ªÉn th·ªã dropdown khi r√™ chu·ªôt ho·∫∑c click */
.dropdown:hover .dropdown-menu,
.dropdown.open .dropdown-menu {
    display: block;
    z-index: 9999; /* Menu con lu√¥n n·∫±m tr√™n c√°c th√†nh ph·∫ßn kh√°c */

}

/* Menu con */
.dropdown-menu {
    display: none;    /* ·∫®n menu m·∫∑c ƒë·ªãnh */
    position: absolute; 	/* ƒê·∫£m b·∫£o menu xu·∫•t hi·ªán t·∫°i v·ªã tr√≠ c·ªë ƒë·ªãnh */
    top: 100%; 	/* ƒê·∫∑t menu ngay b√™n d∆∞·ªõi m·ª•c "Demos" */
    right: 20;
    left: 5px; /* Di chuy·ªÉn v√†o b√™n tr√°i m·ªôt ch√∫t */
    background-color: #ffffff;
    border: 1px solid #ddd;
    border-radius: 5px;
    min-width: 150px; /* Chi·ªÅu r·ªông t·ªëi thi·ªÉu */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    z-index: 9999; /* ∆Øu ti√™n hi·ªÉn th·ªã cao nh·∫•t */
    padding: 4px 5px; /* Ch·ªânh ƒë·ªô r·ªông cho dropdown menu */
    max-width: 100%; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông t·ªëi ƒëa */
    flex-direction: column; /* Hi·ªÉn th·ªã theo chi·ªÅu d·ªçc */

}
.dropdown-menu * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}


/* Dropdown items */
.dropdown-menu li a {
    color: #333;
    padding: 5px 10px;
    font-size: 0.9rem;
    text-decoration: none;
    display: block;
    background-color: transparent; /* N·ªÅn trong su·ªët */
    margin: 0; /* Lo·∫°i b·ªè kho·∫£ng c√°ch kh√¥ng c·∫ßn thi·∫øt */
    width: 100%; /* ƒê·∫£m b·∫£o chi·ªÅu ngang ƒë·ªìng ƒë·ªÅu */
    min-width: 100px; /* Chi·ªÅu r·ªông t·ªëi thi·ªÉu */
    text-align: left; /* CƒÉn ch·ªØ v·ªÅ b√™n tr√°i */
   

}

.dropdown-menu li a:hover {
    background-color: #f0f0f0; /* Hi·ªÉn th·ªã n·ªÅn khi hover */
    color: #000; /* M√†u ch·ªØ khi hover */

}

/* About Section Styling */
#about-section {
    padding: 20px;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin: 20px auto;
    max-width: 800px;

}

/* Ch·ªâ ƒë·ªãnh ·∫£nh trong trang Gi·ªõi Thi·ªáu */
#about-section .profile-picture {
    display: flex;
    justify-content: center; /* CƒÉn gi·ªØa n·ªôi dung */
    margin-top: 20px;
}

#about-section .profile-picture img {
    width: 180px;
    height: 180px;
    border-radius: 50%;
    border: 4px solid #4CAF50;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}


/* Styling cho About Section */
.about-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: #ffffff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin: 20px auto;
    max-width: 800px;
}

.profile-picture img {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    border: 4px solid #4CAF50;
    object-fit: cover;
}

.about-content {
    flex: 1;
    margin-left: 20px;
}

.about-content h2 {
    color: #333;
    font-size: 24px;
    margin-bottom: 10px;
}

.about-content p {
    font-size: 16px;
    color: #555;
    line-height: 1.5;
}

/* Show dropdown on hover */
.dropdown:hover .dropdown-menu {
    display: block;
}


/* N·ªôi dung ch√≠nh ch·ªânh z-index th·∫•p h∆°n dropdown */
.input-section {
    margin-bottom: 30px;
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

   /* Ch·ªânh l·∫°i b·∫£ng d·ªØ li·ªáu */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    padding: 12px;
    text-align: left;
    border: 1px solid #ddd;
}

th {
    background-color: #f4f4f4;
}


#login-section, #change-password-section {
    margin: 20px 0;
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    z-index: 10; /* Hi·ªÉn th·ªã tr√™n c√°c ph·∫ßn kh√°c n·∫øu c·∫ßn */

}

.action-buttons {
    display: flex;
    justify-content: center; /* CƒÉn gi·ªØa theo chi·ªÅu ngang */
    margin-top: 20px; /* Th√™m kho·∫£ng c√°ch ph√≠a tr√™n */
    gap: 15px; /* Kho·∫£ng c√°ch gi·ªØa 2 n√∫t */
}

.action-buttons button {
    padding: 12px 24px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background-color: #4caf50;
    color: white;
    transition: background-color 0.3s ease;
}

.action-buttons button:hover {
    background-color: #45a049;
}

.submenu-list {
    left: calc(100% - 20px); /* D·ªãch menu con sang tr√°i 20px */
    display: none;
    position: absolute;
    left: 100%;
    top: 0;
    background-color: white;
    border: 1px solid #ddd;
    padding: 10px;
    min-width: 150px;
}

.submenu-list li a {
    padding-left: 10px; /* Th√™m kho·∫£ng c√°ch b√™n tr√°i cho text */
}

/* Hi·ªÉn th·ªã menu con khi hover */
.dropdown-menu li:hover .submenu-list {
    display: block;
}

/* Gi·ªØ menu con m·ªü khi hover */
.dropdown.open .submenu-list {
    display: block;
}

.fixed-title {
    position: fixed; /* ƒê·∫∑t ti√™u ƒë·ªÅ c·ªë ƒë·ªãnh */
    top: 10px; /* C√°ch ph√≠a tr√™n 10px */
    left: 10px; /* C√°ch b√™n tr√°i 10px */
    margin: 0; /* Lo·∫°i b·ªè margin m·∫∑c ƒë·ªãnh */
    font-size: 1rem; /* C·ª° ch·ªØ ph√π h·ª£p */
    font-weight: bold; /* In ƒë·∫≠m ti√™u ƒë·ªÅ */
    color: black; /* M√†u ch·ªØ xanh l√° */
    background-color: white; /* N·ªÅn tr·∫Øng cho d·ªÖ nh√¨n */
    padding: 5px 15px; /* T·∫°o kho·∫£ng c√°ch b√™n trong cho ti√™u ƒë·ªÅ */
    border-radius: 5px; /* Bo g√≥c nh·∫π */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* T·∫°o ƒë·ªï b√≥ng nh·∫π */
    z-index: 1000; /* ƒê·∫£m b·∫£o ti√™u ƒë·ªÅ lu√¥n n·∫±m tr√™n c√°c ph·∫ßn t·ª≠ kh√°c */
}

.section-header.highlight {
background: linear-gradient(135deg, #ffffff, #f5f5f5); /* Tr·∫Øng pha x√°m s√°ng nh·∫π */
    color: white; /* M√†u ch·ªØ n·ªïi b·∫≠t */
    padding: 5px; /* Kho·∫£ng c√°ch h·ª£p l√Ω */
    margin: 5px auto; /* Kho·∫£ng c√°ch tr√™n d∆∞·ªõi */
    font-size: 1.5rem; /* K√≠ch th∆∞·ªõc ch·ªØ l·ªõn ƒë·ªÉ thu h√∫t */
    font-weight: bold; /* Ch·ªØ in ƒë·∫≠m */
    text-align: center; /* CƒÉn gi·ªØa vƒÉn b·∫£n */
    border-radius: 12px; /* Bo g√≥c m·ªÅm m·∫°i */
    max-width: 1200px; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); /* T·∫°o chi·ªÅu s√¢u cho ch·ªØ */
    animation: fadeIn 1s ease-out; /* Hi·ªáu ·ª©ng xu·∫•t hi·ªán */
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

#history-section {
    display: block !important;
}

    </style>

</head>

<header>

    <div id="notification" style="display: none;" class="notification">
        <p id="notification-message"></p>
    </div>

    <div class="header-container">
        <div class="logo">
            <img src="static/images/logo.png" alt="Logo">
    </div>
 
   <!-- Menu ƒêi·ªÅu H∆∞·ªõng -->
<nav>
    <ul class="nav-bar">
        <!-- Menu LeLife -->
        <li class="dropdown">
            <a href="#" id="lelifetoggle">LeLife</a>
            <ul class="dropdown-menu" id="lelifemenu">
                <li><a href="./index.html" onclick="showSection('about-ai-section')">Gi·ªõi thi·ªáu</a></li>
            </ul>
        </li>

 <!-- Menu Demos -->
        <li class="dropdown">
            <a href="#" id="demostoggle">Demos ‚ñº</a>
            <ul class="dropdown-menu" id="demosmenu">
                <!-- EtsyAds-AI -->
                <li class="submenu">
                    <a href="./etsyadsai.html" onclick="showSection('etsyads-ai-section')">EtsyAds-AI ‚ñº</a>
                    <ul class="submenu-list">
                        <li><a href="#" onclick="showSection('history-section')">L·ªãch S·ª≠ Ph√¢n T√≠ch</a></li>
                    </ul>
                </li>
                <!-- AmazonTrend-AI -->
                <a href="./amazontrend.html" onclick="showSection('etsyads-ai-section')">AmazonTrend-AI</a>
            </ul>
        </li>


        <!-- Menu H∆∞·ªõng D·∫´n -->
        <li class="dropdown">
    		<a href="#" id="guidetoggle">H∆∞·ªõng d·∫´n ‚ñº</a>
    		<ul class="dropdown-menu" id="guidemenu">
       	 		<li><a href="./sach.html" onclick="showSection('sach-ai-section')">S√°ch</a></li>
        		<li><a href="./coaching.html" onclick="showSection('coaching-section')">Coaching</a></li>
       			<li><a href="./congcu.html" onclick="showSection('congcu-section')">C√¥ng C·ª•</a></li>
    		</ul>
	</li>
    </ul>
</nav>


</header>

    
<body>

<div class="container">
    <div class="input-section">
<div class="section-header highlight"> EtsyAds-AI ‚Äì Tool AI t·ª± ƒë·ªông x·ª≠ l√Ω ads, do LeLifeAI t·∫°o ra. Website n√†y c≈©ng l√† s·∫£n ph·∫©m t·ª´ ch√≠nh AI!</div>

   </div>
    </div>
</section>


<section id="change-password-section" class="content-section" style="display:none;">
    <div class="auth-section">
        <h3>ƒê·ªïi m·∫≠t kh·∫©u</h3>
        <label for="username">T√™n ng∆∞·ªùi d√πng:</label>
        <input type="text" id="username" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi d√πng">
        <label for="old-password">M·∫≠t kh·∫©u c≈©:</label>
        <input type="password" id="old-password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u c≈©">
        <label for="new-password">M·∫≠t kh·∫©u m·ªõi:</label>
        <input type="password" id="new-password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi">
        <button onclick="changePassword()">ƒê·ªïi m·∫≠t kh·∫©u</button>
    </div>
</section>

<section id="user-list-section" class="content-section" style="display:none;">
    <div id="user-list">
        <h3>Danh s√°ch ng∆∞·ªùi d√πng</h3>
        <ul id="users"></ul>
    </div>
</section>

<section id="admin-dashboard" class="content-section" style="display: none;">
    <h3>Admin Dashboard - Qu·∫£n L√Ω Ng∆∞·ªùi D√πng</h3>
    <table id="user-table" border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>T√™n Ng∆∞·ªùi D√πng</th>
                <th>H√†nh ƒê·ªông</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>


<section id="history-section" class="content-section" style="display: none;">
    <h3>L·ªãch S·ª≠ Ph√¢n T√≠ch</h3>
    
    <!-- Th√™m canvas cho bi·ªÉu ƒë·ªì -->
    <canvas id="historyChart" style="max-width: 100%; margin-bottom: 20px;"></canvas>
    
    <!-- B·∫£ng d·ªØ li·ªáu ph√¢n t√≠ch -->
    <table id="history-table" border="1">
        <thead>
            <tr>
                <th>Th·ªùi Gian</th>
                <th>CTR (%)</th>
                <th>CR (%)</th>
                <th>CPP (USD)</th>
                <th>ROI (%)</th>
                <th>Fee Ads (%)</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <button class="button" onclick="deleteHistory()">X√≥a L·ªãch S·ª≠</button>
</section>


        <!-- Th·ªùi gian ch·∫°y ads -->
        <div class="row">
            <label>Ch·ªçn th·ªùi gian ph√¢n t√≠ch ads:</label>
            <div>
                <label for="start-date">B·∫Øt ƒë·∫ßu:</label>
                <input type="date" id="start-date" required>
            </div>
            <div>
                <label for="end-date">K·∫øt th√∫c:</label>
                <input type="date" id="end-date" required>
            </div>
        </div>

        <!-- C√°c ch·ªâ s·ªë qu·∫£ng c√°o -->
        <div class="row">
            <div>
                <label for="views">L∆∞·ª£t xem:</label>
                <input type="number" id="views" placeholder="Nh·∫≠p s·ªë l∆∞·ª£t xem">
            </div>
            <div>
                <label for="clicks">L∆∞·ª£t nh·∫•p chu·ªôt:</label>
                <input type="number" id="clicks" placeholder="Nh·∫≠p s·ªë l∆∞·ª£t nh·∫•p">
            </div>
            <div>
                <label for="orders">ƒê∆°n h√†ng:</label>
                <input type="number" id="orders" placeholder="Nh·∫≠p s·ªë ƒë∆°n h√†ng">
            </div>
            <div>
                <label for="revenue">Doanh thu (USD):</label>
                <input type="number" id="revenue" placeholder="Nh·∫≠p doanh thu">
            </div>
            <div>
                <label for="spend">Chi ph√≠ qu·∫£ng c√°o (USD):</label>
                <input type="number" id="spend" placeholder="Nh·∫≠p chi ph√≠ qu·∫£ng c√°o">
            </div>

        </div>

        <!-- Th·ªùi gian b√°n h√†ng -->
        <div class="row" style="margin-top: 20px;">
            <label> Doanh Thu&Chi ph√≠ theo khung th·ªùi gian:</label>
            <div>
                <label for="sales-start-date">B·∫Øt ƒë·∫ßu:</label>
                <input type="date" id="sales-start-date" required>
            </div>
            <div>
                <label for="sales-end-date">K·∫øt th√∫c:</label>
                <input type="date" id="sales-end-date" required>
            </div>
        </div>

        <!-- C√°c ch·ªâ s·ªë b√°n h√†ng -->
        <div class="row">
            <div>
                <label for="sales">Doanh thu(USD):</label>
                <input type="number" id="sales" placeholder="Sales">
            </div>
            <div>
                <label for="marketing">Chi ph√≠ MKT(USD):</label>
                <input type="number" id="marketing" placeholder="Marketing">
            </div>
            <div>
                <label for="fees">Ph√≠ Etsy(USD):</label>
                <input type="number" id="fees" placeholder="Ph√≠">
            </div>
        </div>


<!-- Ng∆∞·ª°ng Gi√° Tr·ªã Trung B√¨nh (Tu·ª≥ Ch·ªçn) -->
<div class="threshold-section">
    <h3>Ng∆∞·ª°ng Gi√° Tr·ªã Trung B√¨nh (Tu·ª≥ Ch·ªçn)</h3>
    <div class="threshold-inputs">
        <div>
            <label for="ctr-threshold">CTR (%):</label>
            <input type="number" id="ctr-threshold" placeholder="2" value="2">
        </div>
        <div>
            <label for="cr-threshold">CR (%):</label>
            <input type="number" id="cr-threshold" placeholder="2.5" value="2.5">
        </div>
        <div>
            <label for="cpp-threshold">CPP (USD):</label>
            <input type="number" id="cpp-threshold" placeholder="10" value="10">
        </div>
        <div>
            <label for="fee-ads-threshold">Fee Ads (%):</label>
            <input type="number" id="fee-ads-threshold" placeholder="20" value="20">
        </div>
        <div>
            <label for="roi-threshold">ROI (%):</label>
            <input type="number" id="roi-threshold" placeholder="75" value="75">
        </div>
    </div>
</div>

    </div>

<div class="action-buttons">
    <button id="analyze-button" onclick="analyzeData()">Ph√¢n t√≠ch</button>
</div>

<div class="result-section">
    <h3 class="section-header">K·∫øt Qu·∫£ Ph√¢n T√≠ch</h3>
    <div id="analysis-results" class="results">
        Ch∆∞a c√≥ d·ªØ li·ªáu ph√¢n t√≠ch.
    </div>

        <div class="section-header">ƒê·ªÅ Xu·∫•t H√†nh ƒê·ªông</div>
        <div class="proposals">
            <p id="proposals">C√°c ƒë·ªÅ xu·∫•t s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
        </div>
    </div>

<div class="action-buttons">
    <button id="save-history" onclick="saveHistory()">L∆∞u K·∫øt Qu·∫£</button>
</div>


  <div class="chart-section">
    <h3 class="section-header">Bi·ªÉu ƒê·ªì So S√°nh</h3>
    <div class="chart-container">
        <canvas id="comparison-chart" class="chart" style="max-width: 800px; margin: auto;"></canvas>
    </div>
</div>

    <div class="flex-container">
        <canvas id="chart-ctr" class="chart"></canvas>
        <canvas id="chart-cr" class="chart"></canvas>
        <canvas id="chart-cpp" class="chart"></canvas>
        <canvas id="chart-fee" class="chart"></canvas>
        <canvas id="chart-roi" class="chart"></canvas>
        <canvas id="historyChart"></canvas>
    </div>
</div>

</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", renderHistoryChart);
</script>

<script>
document.addEventListener("DOMContentLoaded", async function () {
    console.log("üì¢ Trang ƒë√£ t·∫£i xong, g·ªçi renderHistoryChart()");
    await renderHistoryChart();  // ƒê·∫£m b·∫£o g·ªçi API ngay khi trang t·∫£i
});
</script>


<script>
    const API_URL = "https://etsyads-backend.onrender.com/etsyads";

// Ki·ªÉm tra URL c√≥ ch·ª©a token kh√¥ng
 document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");
    const resetForm = document.getElementById("reset-password-form");

    console.log("üîç Trang hi·ªán t·∫°i:", window.location.pathname);

    // ‚úÖ Ch·ªâ ki·ªÉm tra token n·∫øu ƒëang ·ªü reset-password.html
    if (!window.location.pathname.includes("reset-password.html")) {
        console.log("‚úÖ Kh√¥ng ph·∫£i trang reset-password, b·ªè qua ki·ªÉm tra token.");
        return;
    }

    console.log("üîç Token t·ª´ URL:", token);

    if (!token) {
        console.warn("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y token. ·∫®n form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.");
        if (resetForm) resetForm.style.display = "none";
        alert("Kh√¥ng t√¨m th·∫•y token h·ª£p l·ªá. Vui l√≤ng th·ª≠ l·∫°i.");
    } else {
        console.log("‚úÖ Token h·ª£p l·ªá, hi·ªÉn th·ªã form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.");
        if (resetForm) resetForm.style.display = "block";
    }
});



//Hi·ªÉn th·ªã th√¥ng b√°o
function showNotification(message, type = 'success') {
    const notification = document.getElementById('notification');
    const messageElement = document.getElementById('notification-message');
    
    messageElement.textContent = message;
    notification.style.backgroundColor = type === 'success' ? '#4caf50' : '#f44336';
    notification.style.display = 'block';

    setTimeout(() => {
        notification.style.display = 'none';
    }, 3000);
}

// H√†m ƒëƒÉng k√Ω ng∆∞·ªùi d√πng
async function registerUser() {
    const username = document.getElementById("reg-username").value.trim();
    const email = document.getElementById("reg-email").value.trim();
    const password = document.getElementById("reg-password").value.trim();

    if (!username || !email || !password) {
        alert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!");
        return;
    }

    const payload = {
        username: username,
        email: email,
        password: password,
    };

    console.log("D·ªØ li·ªáu g·ª≠i ƒëi:", payload);

    try {
        const response = await fetch(`${API_URL}/register/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
        });

        const result = await response.json();
        if (response.ok) {
            alert("ƒêƒÉng k√Ω th√†nh c√¥ng!");
            toggleLoginForm(); // Quay l·∫°i form ƒëƒÉng nh·∫≠p
        } else {
            console.error("L·ªói ƒëƒÉng k√Ω:", result);
            alert(`L·ªói khi ƒëƒÉng k√Ω: ${result.detail}`);
        }
    } catch (error) {
        console.error("L·ªói khi ƒëƒÉng k√Ω:", error);
        alert("C√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i.");
    }
}


// H√†m ƒëƒÉng nh·∫≠p

// H√†m g·ª≠i email kh√¥i ph·ª•c m·∫≠t kh·∫©u
async function sendResetPasswordEmail() {
    const email = document.getElementById("fp-email").value.trim();

    if (!email) {
        alert("Vui l√≤ng nh·∫≠p email!");
        return;
    }

    const payload = { email: email };

    try {
        const response = await fetch(`${API_URL}/forgot-password/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
        });

        if (response.ok) {
            alert("Email kh√¥i ph·ª•c ƒë√£ ƒë∆∞·ª£c g·ª≠i!");
        } else {
            const result = await response.json();
            alert(`L·ªói: ${result.detail}`);
        }
    } catch (error) {
        console.error("L·ªói khi g·ª≠i email kh√¥i ph·ª•c:", error);
        alert("C√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i.");
    }
}

async function resetPassword() {
    const token = new URLSearchParams(window.location.search).get("token");
    const newPassword = document.getElementById("new-password").value.trim();

    if (!token || !newPassword) {
        alert("Token ho·∫∑c m·∫≠t kh·∫©u kh√¥ng h·ª£p l·ªá!");
        return;
    }

    try {
        const response = await fetch(`${API_URL}/reset-password/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ token, new_password: newPassword }),
        });

        const result = await response.json();
        if (response.ok) {
            alert("ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u th√†nh c√¥ng!");
            window.location.href = "/static/login.html";
        } else {
            alert(`L·ªói: ${result.detail}`);
        }
    } catch (error) {
        console.error("L·ªói khi ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u:", error);
        alert("ƒê√£ x·∫£y ra l·ªói. Vui l√≤ng th·ª≠ l·∫°i!");
    }
}


// H√†m l∆∞u trang tr∆∞·ªõc v√† quay l·∫°i
function redirectToPreviousPage() {
    const previousPage = localStorage.getItem("previousPage");
    if (previousPage) {
        window.location.href = previousPage;
    } else {
        window.location.href = "C:/Users/QUANG LE/AppData/Local/Programs/Python/Python313/frontend/etsyadsAI.html"; // M·∫∑c ƒë·ªãnh v·ªÅ trang ch·ªß n·∫øu kh√¥ng t√¨m th·∫•y trang tr∆∞·ªõc ƒë√≥
    }
}

// L∆∞u trang hi·ªán t·∫°i tr∆∞·ªõc khi chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω
function saveCurrentPage() {
    localStorage.setItem("previousPage", window.location.href);
}

// G·ªçi h√†m khi ng∆∞·ªùi d√πng truy c·∫≠p trang ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω
window.onload = function () {
    if (window.location.pathname.includes("login") || window.location.pathname.includes("register")) {
        saveCurrentPage();
    }
};

async function changePassword() {
    const username = document.getElementById('username').value;
    const oldPassword = document.getElementById('old-password').value;
    const newPassword = document.getElementById('new-password').value;

    if (!username || !oldPassword || !newPassword) {
        showNotification("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!", "error");
        return;
    }

    try {
        const response = await fetch(`${API_URL}/change_password/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, old_password: oldPassword, new_password: newPassword }),
        });

        if (response.ok) {
            showNotification("ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!", "success");

            // ·∫®n ph·∫ßn ƒê·ªïi M·∫≠t Kh·∫©u
            document.getElementById('change-password-section').style.display = 'none';
        } else {
            alert("L·ªói khi ƒë·ªïi m·∫≠t kh·∫©u.");
        }
    } catch (error) {
        console.error("L·ªói khi ƒë·ªïi m·∫≠t kh·∫©u:", error);
        alert("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.");
    }
}

//l·∫•y danh s√°ch ng∆∞·ªùi d√πng
async function getUsers() {
    try {
        const response = await fetch('/users/');
        const users = await response.json();

        if (Array.isArray(users)) {
            users.forEach(user => {
                console.log(user);
            });
        } else {
            console.error('D·ªØ li·ªáu kh√¥ng ph·∫£i l√† m·∫£ng:', users);
        }
    } catch (error) {
        console.error('L·ªói khi l·∫•y d·ªØ li·ªáu ng∆∞·ªùi d√πng:', error);
    }
}


const element = document.getElementById('some-element');
if (element) {
    element.style.display = 'block';
}

function logoutUser() {
    const token = localStorage.getItem("accessToken");

    if (!token) {
        showNotification("B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p!", "error");
        return;
    }

//l·∫•y danh s√°ch ng∆∞·ªùi d√πng
async function fetchUsers() {
    const token = localStorage.getItem("accessToken");
    if (!token) {
        showNotification("Vui l√≤ng ƒëƒÉng nh·∫≠p!", "error");
        return;
    }

    try {
        const response = await fetch(`${API_URL}/users/`, {
            method: "GET",
            headers: { "Authorization": `Bearer ${token}` }
        });

        if (response.ok) {
            const users = await response.json();
            const userTable = document.querySelector("#user-table tbody");
            userTable.innerHTML = "";

            users.forEach(user => {
                const row = `
                    <tr>
                        <td>${user.id}</td>
                        <td>${user.username}</td>
                        <td><button onclick="deleteUser(${user.id})">X√≥a</button></td>
                    </tr>
                `;
                userTable.insertAdjacentHTML('beforeend', row);
            });
        } else {
            const errorData = await response.json();
            showNotification(`L·ªói: ${errorData.detail}`, "error");
        }
    } catch (error) {
        console.error("L·ªói khi t·∫£i danh s√°ch ng∆∞·ªùi d√πng:", error);
        showNotification("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.", "error");
    }
}


// g·ª≠i y√™u c·∫ßu x√≥a ng∆∞·ªùi d√πng qua API
async function deleteUser(userId) {
    const token = localStorage.getItem("accessToken");
    if (!token) {
        showNotification("Vui l√≤ng ƒëƒÉng nh·∫≠p!", "error");
        return;
    }

    if (!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ng∆∞·ªùi d√πng n√†y?")) return;

    try {
        const response = await fetch(`${API_URL}/users/${userId}`, {
            method: "DELETE",
            headers: { "Authorization": `Bearer ${token}` }
        });

        if (response.ok) {
            showNotification("X√≥a ng∆∞·ªùi d√πng th√†nh c√¥ng!", "success");
            fetchUsers();  // L√†m m·ªõi danh s√°ch sau khi x√≥a
        } else {
            showNotification("L·ªói khi x√≥a ng∆∞·ªùi d√πng.", "error");
        }
    } catch (error) {
        console.error("L·ªói khi x√≥a ng∆∞·ªùi d√πng:", error);
        showNotification("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.", "error");
    }
}


    // G·ªçi API ƒë·ªÉ ƒëƒÉng xu·∫•t (n·∫øu backend c√≥ h·ªó tr·ª£)
    fetch(`${API_URL}/logout/`, { method: "POST", headers: { "Authorization": `Bearer ${token}` } })
        .then(response => {
            if (response.ok) {
                localStorage.removeItem("accessToken");
                showNotification("ƒê√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng!", "success");

                // Hi·ªÉn th·ªã l·∫°i form ƒêƒÉng Nh·∫≠p
                document.getElementById('login-section').style.display = 'block';
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'none';
                });
            } else {
                showNotification("L·ªói khi ƒëƒÉng xu·∫•t!", "error");
            }
        })
        .catch(error => {
            console.error("L·ªói khi ƒëƒÉng xu·∫•t:", error);
            showNotification("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.", "error");
        });
}

document.querySelectorAll('nav a').forEach(link => {
    link.addEventListener('click', event => {
        const target = event.currentTarget;

        // L·∫•y URL hi·ªán t·∫°i
        const currentUrl = window.location.href;

        // Ki·ªÉm tra n·∫øu c√≥ l·∫∑p "frontend/frontend"
        if (currentUrl.includes('frontend/frontend')) {
            // Lo·∫°i b·ªè l·∫∑p "frontend/frontend"
            const correctedUrl = currentUrl.replace('/frontend/frontend', '/frontend');
            window.location.href = correctedUrl; // Chuy·ªÉn h∆∞·ªõng v·ªÅ URL chu·∫©n
        }
    });
});

document.addEventListener("DOMContentLoaded", function () {
    const etsyadsToggle = document.getElementById("etsyads-toggle");
    const etsyadsMenu = document.getElementById("etsyads-menu");
    const historyToggle = document.getElementById("history-toggle");
    const historySection = document.getElementById("history-section");

    // ‚úÖ X·ª≠ l√Ω m·ªü/ƒë√≥ng ph·∫ßn L·ªãch S·ª≠ Ph√¢n T√≠ch khi nh·∫•n v√†o submenu c·ªßa EtsyAds-AI
    etsyadsToggle.addEventListener("click", function (event) {
        event.preventDefault();
        
        // Ki·ªÉm tra n·∫øu menu ƒëang hi·ªÉn th·ªã th√¨ ch·ªâ ·∫©n L·ªãch S·ª≠ Ph√¢n T√≠ch
        if (etsyadsMenu.style.display === "block") {
            etsyadsMenu.style.display = "none";  // ·∫®n L·ªãch S·ª≠ Ph√¢n T√≠ch
        } else {
            etsyadsMenu.style.display = "block"; // Hi·ªán L·ªãch S·ª≠ Ph√¢n T√≠ch
        }
    });

    // ‚úÖ X·ª≠ l√Ω m·ªü/ƒë√≥ng n·ªôi dung L·ªãch S·ª≠ Ph√¢n T√≠ch khi nh·∫•n v√†o submenu c·ªßa EtsyAds-AI
    historyToggle.addEventListener("click", function (event) {
        event.preventDefault();
        historySection.style.display = historySection.style.display === "block" ? "none" : "block";
    });

    // ‚úÖ ƒê√≥ng menu n·∫øu click b√™n ngo√†i
    document.addEventListener("click", function (event) {
        if (!etsyadsToggle.contains(event.target) && !etsyadsMenu.contains(event.target)) {
            etsyadsMenu.style.display = "none"; // ·∫®n L·ªãch S·ª≠ Ph√¢n T√≠ch nh∆∞ng kh√¥ng ·∫©n EtsyAds-AI
        }
    });
});

 
document.addEventListener("DOMContentLoaded", function () {
    console.log("S·ª± ki·ªán DOMContentLoaded ƒë√£ ch·∫°y.");

    // ‚úÖ X·ª≠ l√Ω submenu dropdown
    document.querySelectorAll(".dropdown > a").forEach(function (element) {
        element.addEventListener("click", function (event) {
            event.preventDefault();
            const parentDropdown = this.parentElement;
            parentDropdown.classList.toggle("open");
        });
    });

    // ‚úÖ ƒê√≥ng menu dropdown khi click ra ngo√†i
    document.addEventListener('click', function (event) {
    const dropdowns = document.querySelectorAll('.dropdown');
    dropdowns.forEach(function (dropdown) {
        if (!dropdown.contains(event.target) && !event.target.closest('.dropdown-menu')) {
            dropdown.classList.remove('open');
        }
    });
});

    // ‚úÖ Ki·ªÉm tra token reset-password m√† kh√¥ng ·∫£nh h∆∞·ªüng dropdown
    checkResetToken();
});

function displayRecommendation(data) {
    let recommendationBox = document.getElementById("recommendationBox");
    recommendationBox.innerHTML = "<h2><strong>ƒê·ªÄ XU·∫§T H√ÄNH ƒê·ªòNG</strong></h2>";

    // ‚úÖ Ki·ªÉm tra n·∫øu c√≥ l·ªói
    if (data.error) {
        recommendationBox.innerHTML += `<p style="color: red;">L·ªói khi ph√¢n t√≠ch: ${data.error}</p>`;
        return;
    }

    // ‚úÖ Ki·ªÉm tra n·∫øu `recommendation` l√† object
    let recommendationText = "";
    if (typeof data.recommendation === "string") {
        recommendationText = data.recommendation;  // L·∫•y chu·ªói text
    } else if (Array.isArray(data.recommendation)) {
        recommendationText = data.recommendation.join("<br>");  // N·∫øu l√† m·∫£ng, n·ªëi l·∫°i th√†nh chu·ªói
    } else {
        recommendationText = JSON.stringify(data.recommendation);  // N·∫øu kh√¥ng, stringify l·∫°i
    }

    recommendationBox.innerHTML += `<p>${recommendationText}</p>`;
    recommendationBox.style.display = "block";
}


// ‚úÖ H√ÄM KI·ªÇM TRA TOKEN RESET PASSWORD
function checkResetToken() {
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");
    const resetForm = document.getElementById("reset-password-form");

    console.log("üîç Trang hi·ªán t·∫°i:", window.location.pathname);

    // ‚úÖ Ch·ªâ ki·ªÉm tra token n·∫øu ƒëang ·ªü reset-password.html
    if (!window.location.pathname.includes("reset-password.html")) {
        console.log("‚úÖ Kh√¥ng ph·∫£i trang reset-password, b·ªè qua ki·ªÉm tra token.");
        return;
    }

    console.log("üîç Token t·ª´ URL:", token);

    if (token) {
        token = decodeURIComponent(token);
        console.log("‚úÖ Token h·ª£p l·ªá, hi·ªÉn th·ªã form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.");
        if (resetForm) resetForm.style.display = "block";
    } else {
        console.warn("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y token. ·∫®n form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.");
        if (resetForm) resetForm.style.display = "none";
        alert("Kh√¥ng t√¨m th·∫•y token h·ª£p l·ªá. Vui l√≤ng th·ª≠ l·∫°i.");
    }
}

function showSection(sectionId) {
    // ·∫®n t·∫•t c·∫£ c√°c section
    const sections = document.querySelectorAll('section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Hi·ªÉn th·ªã ph·∫ßn ƒë∆∞·ª£c ch·ªçn (v√≠ d·ª•: about-section)
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.style.display = 'block';
    }

    // N·∫øu ch·ªçn "about-section", ·∫©n t·∫•t c·∫£ c√°c ph·∫ßn d∆∞ th·ª´a kh√°c
    if (sectionId === 'about-section') {
        // ·∫®n c√°c th√†nh ph·∫ßn kh√¥ng li√™n quan
        document.querySelectorAll('.input-section, .result-section, .chart-section, .action-buttons, .threshold-section, .row')
            .forEach(el => el.style.display = 'none');

        // Hi·ªÉn th·ªã Gi·ªõi Thi·ªáu
        const aboutSection = document.getElementById('about-section');
        if (aboutSection) {
            aboutSection.style.display = 'block';
        }
    }
}

const charts = {};
let chartInstances = [];
let comparisonChart = null;

// X·ª≠ l√Ω s·ª± ki·ªán click v√†o n√∫t Demos
document.getElementById('demos-toggle').addEventListener('click', function (e) {
    e.preventDefault();
    const menu = document.getElementById('demos-menu');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
});

// ·∫®n menu khi click ra ngo√†i
document.addEventListener('click', function (e) {
    const toggle = document.getElementById('demos-toggle');
    const menu = document.getElementById('demos-menu');

    if (!toggle.contains(e.target) && !menu.contains(e.target)) {
        menu.style.display = 'none';
    }
});

// Ki·ªÉm tra tr·∫°ng th√°i ƒëƒÉng nh·∫≠p khi t·∫£i trang
document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    let token = urlParams.get("token");

    console.log("üîç Token t·ª´ URL:", token);  // ‚úÖ Debug token

    if (!token) {
        console.warn("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y token. ·∫®n form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.");
        document.getElementById("reset-password-form").style.display = "none";
        return;
    }

    // ‚úÖ N·∫øu c√≥ token, hi·ªÉn th·ªã form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u
    document.getElementById("reset-password-form").style.display = "block";
});

//G·ªçi h√†m n√†y khi ng∆∞·ªùi d√πng nh·∫•p v√†o tab L·ªãch S·ª≠ Ph√¢n T√≠ch
document.addEventListener("DOMContentLoaded", () => {
    console.log("Trang ƒë√£ t·∫£i xong. Kh√¥ng hi·ªÉn th·ªã form m·∫∑c ƒë·ªãnh.");
    document.querySelector('a[href="#history-section"]').addEventListener('click', fetchHistory);
});

// Hi·ªÉn th·ªã n√∫t ƒêƒÉng Xu·∫•t n·∫øu ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p
    document.addEventListener("DOMContentLoaded", () => {
        const token = localStorage.getItem("accessToken");
        if (token) {
            document.querySelector('a[href="#logout"]').style.display = 'block';
        } else {
            document.querySelector('a[href="#logout"]').style.display = 'none';
        }
    });


document.addEventListener("DOMContentLoaded", () => {
    const urlParams = new URLSearchParams(window.location.search);
    const section = urlParams.get('section');

    if (section) {
        showSection(section);
    }
});


document.addEventListener("DOMContentLoaded", async () => {
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");

    if (token) {
        try {
            // G·ª≠i y√™u c·∫ßu ki·ªÉm tra token
            const response = await fetch(`http://localhost:8000/reset-password/?token=${token}`, {
                method: "GET",
            });

            if (response.ok) {
                const result = await response.json();
                console.log("Token h·ª£p l·ªá, hi·ªÉn th·ªã form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u:", result);

                // Hi·ªÉn th·ªã form ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u
                document.getElementById("reset-password-section").style.display = "block";
            } else {
                throw new Error("Token kh√¥ng h·ª£p l·ªá");
            }
        } catch (error) {
            console.error("L·ªói khi x√°c minh token:", error);
            alert("Li√™n k·∫øt ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n.");
        }
    } else {
        alert("Token kh√¥ng t·ªìn t·∫°i trong URL.");
    }
});


// H√†m l·∫•y l·ªãch s·ª≠ ph√¢n t√≠ch
async function fetchHistory() {
    try {
        const response = await fetch(`${API_URL}/history/`);
        if (!response.ok) {
            throw new Error(`L·ªói khi t·∫£i l·ªãch s·ª≠: ${response.status}`);
        }
        const history = await response.json();

        const historyTable = document.querySelector("#history-table tbody");
        historyTable.innerHTML = "";

        if (history.length === 0) {
            historyTable.innerHTML = "<tr><td colspan='6'>Kh√¥ng c√≥ d·ªØ li·ªáu ph√¢n t√≠ch.</td></tr>";
            return;
        }

        history.forEach(entry => {
            const row = `
                <tr>
                    <td>${new Date(entry.timestamp).toLocaleString()}</td>
                    <td>${entry.ctr.toFixed(2)}%</td>
                    <td>${entry.cr.toFixed(2)}%</td>
                    <td>$${entry.cpp.toFixed(2)}</td>
                    <td>${entry.roi.toFixed(2)}%</td>
                    <td>${entry.fee_ads.toFixed(2)}%</td>
                </tr>
            `;
            historyTable.insertAdjacentHTML('beforeend', row);
        });

        console.log("ƒê√£ hi·ªÉn th·ªã d·ªØ li·ªáu l√™n b·∫£ng.");
    } catch (error) {
        console.error("L·ªói khi t·∫£i l·ªãch s·ª≠:", error);
    }
}


// ƒê·ªãnh nghƒ©a h√†m deleteHistory
   async function deleteHistory() {
    if (!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô l·ªãch s·ª≠?")) return;

    try {
        const response = await fetch(`${API_URL}/history/`, { method: "DELETE" });

        if (response.ok) {
            showNotification("L·ªãch s·ª≠ ƒë√£ ƒë∆∞·ª£c x√≥a th√†nh c√¥ng!", "success");
            await fetchHistory();  // L√†m m·ªõi b·∫£ng sau khi x√≥a
        } else {
            showNotification("L·ªói khi x√≥a l·ªãch s·ª≠.", "error");
        }
    } catch (error) {
        console.error("L·ªói khi x√≥a l·ªãch s·ª≠:", error);
        showNotification("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.", "error");
    }
}


// Th√™m H√†m JavaScript L∆∞u L·ªãch S·ª≠
async function saveHistory() {
    console.log("üöÄ Ghi d·ªØ li·ªáu l·ªãch s·ª≠ v√†o API...");

    // Thu th·∫≠p d·ªØ li·ªáu th·ª±c t·∫ø t·ª´ form nh·∫≠p
    const historyData = {
        ctr: parseFloat(document.getElementById('ctr-threshold').value) || 2,
        cr: parseFloat(document.getElementById('cr-threshold').value) || 2.5,
        cpp: parseFloat(document.getElementById('cpp-threshold').value) || 10,
        fee_ads: parseFloat(document.getElementById('fee-ads-threshold').value) || 20,
        roi: parseFloat(document.getElementById('roi-threshold').value) || 75
    };

    console.log("üìä D·ªØ li·ªáu g·ª≠i l√™n API:", historyData);

    try {
        const response = await fetch("https://etsyads-backend.onrender.com/etsyads/history/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(historyData)
        });

        if (response.ok) {
            console.log("‚úÖ D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!");
            alert("L·ªãch s·ª≠ ph√¢n t√≠ch ƒë√£ ƒë∆∞·ª£c l∆∞u!");
            
            // C·∫≠p nh·∫≠t bi·ªÉu ƒë·ªì ngay sau khi l∆∞u d·ªØ li·ªáu
            await renderHistoryChart();  
        } else {
            console.error("‚ùå L·ªói khi l∆∞u d·ªØ li·ªáu:", await response.json());
        }
    } catch (error) {
        console.error("‚ùå L·ªói k·∫øt n·ªëi khi l∆∞u l·ªãch s·ª≠:", error);
    }
}


async function renderHistoryChart() {
    console.log("üöÄ G·ªçi API ƒë·ªÉ c·∫≠p nh·∫≠t bi·ªÉu ƒë·ªì...");

    try {
        const response = await fetch("https://etsyads-backend.onrender.com/etsyads/history/");
        const history = await response.json();

        if (!history.length) {
            console.warn("‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu l·ªãch s·ª≠!");
            return;
        }

        console.log("‚úÖ API tr·∫£ v·ªÅ d·ªØ li·ªáu m·ªõi:", history);

        // H·ªßy bi·ªÉu ƒë·ªì c≈© n·∫øu ƒë√£ c√≥
        const existingChart = Chart.getChart("historyChart");
        if (existingChart) {
            existingChart.destroy();
            console.log("üîÑ ƒê√£ x√≥a bi·ªÉu ƒë·ªì c≈©!");
        }

        // Ki·ªÉm tra n·∫øu <canvas> c√≥ t·ªìn t·∫°i
        const ctx = document.getElementById("historyChart");
        if (!ctx) {
            console.error("‚ùå Kh√¥ng t√¨m th·∫•y <canvas> ƒë·ªÉ v·∫Ω bi·ªÉu ƒë·ªì!");
            return;
        }

        // L·∫•y d·ªØ li·ªáu t·ª´ API
        const labels = history.map(entry => new Date(entry.timestamp).toLocaleString());
        const ctrData = history.map(entry => entry.ctr);
        const crData = history.map(entry => entry.cr);
        const cppData = history.map(entry => entry.cpp);
        const feeAdsData = history.map(entry => entry.fee_ads);
        const roiData = history.map(entry => entry.roi);

        // V·∫Ω bi·ªÉu ƒë·ªì v·ªõi d·ªØ li·ªáu m·ªõi nh·∫•t
        new Chart(ctx.getContext('2d'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    { label: 'CTR (%)', data: ctrData, borderColor: 'blue', fill: false },
                    { label: 'CR (%)', data: crData, borderColor: 'red', fill: false },
                    { label: 'CPP (USD)', data: cppData, borderColor: 'green', fill: false },
                    { label: 'Fee Ads (%)', data: feeAdsData, borderColor: 'purple', fill: false },
                    { label: 'ROI (%)', data: roiData, borderColor: 'orange', fill: false }
                ]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: true, position: 'top' } }
            }
        });

        console.log("‚úÖ Bi·ªÉu ƒë·ªì ƒë√£ c·∫≠p nh·∫≠t th√†nh c√¥ng!");

    } catch (error) {
        console.error("‚ùå L·ªói khi v·∫Ω bi·ªÉu ƒë·ªì:", error);
    }
}



async function refreshAccessToken() {
    const refreshToken = localStorage.getItem("refreshToken");
    if (!refreshToken) return;

    try {
        const response = await fetch(`${API_URL}/refresh/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ refresh_token: refreshToken })
        });

        if (response.ok) {
            const result = await response.json();
            localStorage.setItem("accessToken", result.access_token);
            showNotification("Token ƒë√£ ƒë∆∞·ª£c l√†m m·ªõi!", "success");
        } else {
            showNotification("L·ªói khi l√†m m·ªõi token.", "error");
        }
    } catch (error) {
        console.error("L·ªói khi l√†m m·ªõi token:", error);
        showNotification("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.", "error");
    }
}


async function analyzeData() {

  console.log("D·ªØ li·ªáu g·ª≠i ƒëi t·ª´ analyzeData:");
  const data = {
        views: parseInt(document.getElementById('views').value) || 0,
        clicks: parseInt(document.getElementById('clicks').value) || 0,
        orders: parseInt(document.getElementById('orders').value) || 0,
        revenue: parseFloat(document.getElementById('revenue').value) || 0,
        spend: parseFloat(document.getElementById('spend').value) || 0,
        sales: parseFloat(document.getElementById('sales').value) || 0,
        marketing: parseFloat(document.getElementById('marketing').value) || 0,
        fees: parseFloat(document.getElementById('fees').value) || 0,
        thresholds: {
            ctr: parseFloat(document.getElementById('ctr-threshold').value) || 2,
            cr: parseFloat(document.getElementById('cr-threshold').value) || 2.5,
            cpp: parseFloat(document.getElementById('cpp-threshold').value) || 10,
            fee_ads: parseFloat(document.getElementById('fee-ads-threshold').value) || 20,
            roi: parseFloat(document.getElementById('roi-threshold').value) || 75
        }
    };

    console.log("D·ªØ li·ªáu g·ª≠i ƒëi:", data);

    try {
        const response = await fetch('https://etsyads-backend.onrender.com/etsyads/analyze/', {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        if (!response.ok) {
            console.error(`L·ªói t·ª´ backend: ${response.statusText}`);
            alert(`L·ªói t·ª´ backend: ${response.statusText}`);
            return;
        }

        const result = await response.json();
        console.log("K·∫øt qu·∫£ t·ª´ backend:", result);
        showNotification("Ph√¢n t√≠ch d·ªØ li·ªáu th√†nh c√¥ng!");
       
       // C·∫≠p nh·∫≠t bi·ªÉu ƒë·ªì so s√°nh
       updateChart(result.analysis, data.thresholds);

        // Hi·ªÉn th·ªã K·∫øt Qu·∫£ Ph√¢n T√≠ch
        const analysisResults = result.analysis;
        if (analysisResults) {
            document.getElementById('analysis-results').innerHTML = `
                <p>CTR: ${analysisResults.ctr.toFixed(2)}%</p>
                <p>CR: ${analysisResults.cr.toFixed(2)}%</p>
                <p>CPP: $${analysisResults.cpp.toFixed(2)}</p>
                <p>ROI: ${analysisResults.roi.toFixed(2)}%</p>
                <p>Fee Ads: ${analysisResults.fee_ads.toFixed(2)}%</p>
            `;
        } else {
            document.getElementById('analysis-results').innerHTML = "<p>Kh√¥ng c√≥ d·ªØ li·ªáu ph√¢n t√≠ch.</p>";
        }

        // Hi·ªÉn th·ªã ƒë·ªÅ xu·∫•t h√†nh ƒë·ªông
if (result.recommendation) {
    let recommendationText = result.recommendation;

    // ‚úÖ Ki·ªÉm tra n·∫øu recommendation kh√¥ng ph·∫£i string, chuy·ªÉn v·ªÅ string
    if (typeof recommendationText !== "string") {
        console.warn("‚ö† `recommendation` kh√¥ng ph·∫£i string:", recommendationText);
        recommendationText = JSON.stringify(recommendationText);  // Chuy·ªÉn v·ªÅ chu·ªói ƒë·ªÉ tr√°nh l·ªói
    }

    // ‚úÖ Hi·ªÉn th·ªã ƒë·ªÅ xu·∫•t h√†nh ƒë·ªông
    const proposalsHTML = recommendationText
        .split('<br>')
        .map(proposal => `<p>${proposal.trim()}</p>`)
        .join('');

    document.querySelector('.proposals').innerHTML = proposalsHTML;
} else {
    console.warn("‚ö† Kh√¥ng c√≥ ƒë·ªÅ xu·∫•t n√†o t·ª´ backend.");
    document.querySelector('.proposals').innerHTML = "<p>Kh√¥ng c√≥ ƒë·ªÅ xu·∫•t n√†o.</p>";
}


        //  C·∫≠p nh·∫≠t bi·ªÉu ƒë·ªì
        updateCharts({
            ctr: { current: analysisResults.ctr, average: data.thresholds.ctr },
            cr: { current: analysisResults.cr, average: data.thresholds.cr },
            cpp: { current: analysisResults.cpp, average: data.thresholds.cpp },
            fee_ads: { current: analysisResults.fee_ads, average: data.thresholds.fee_ads },
            roi: { current: analysisResults.roi, average: data.thresholds.roi }
        });

    } catch (error) {
        console.error("L·ªói khi k·∫øt n·ªëi t·ªõi backend:", error);

        if (error.message.includes("Failed to fetch")) {
            alert("Kh√¥ng th·ªÉ k·∫øt n·ªëi t·ªõi backend. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi.");
        } else if (error.message) {
            alert(`ƒê√£ x·∫£y ra l·ªói: ${error.message}`);
        } else {
            console.error("L·ªói kh√°c:", error);
        }
    }
}




async function saveAnalysis() {
    const data = {
        views: parseInt(document.getElementById('views').value) || 0,
        clicks: parseInt(document.getElementById('clicks').value) || 0,
        orders: parseInt(document.getElementById('orders').value) || 0,
        revenue: parseFloat(document.getElementById('revenue').value) || 0,
        spend: parseFloat(document.getElementById('spend').value) || 0,
        sales: parseFloat(document.getElementById('sales').value) || 0,
        marketing: parseFloat(document.getElementById('marketing').value) || 0,
        fees: parseFloat(document.getElementById('fees').value) || 0
    };

    try {
        const response = await fetch(`${API_URL}/analysis/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        if (response.ok) {
            alert("D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!");
        } else {
            alert("L·ªói khi l∆∞u d·ªØ li·ªáu.");
        }

    } catch (error) {
        console.error("L·ªói l∆∞u d·ªØ li·ªáu:", error);
    }
}


// H√†m v·∫Ω bi·ªÉu ƒë·ªì

function renderChart(canvasId, label, data, backgroundColor) {
    const canvas = document.getElementById(canvasId);
    if (!canvas) {
        console.error(`Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ canvas v·ªõi ID: ${canvasId}`);
        return;
    }

    const ctx = canvas.getContext('2d');

    // Ph√° h·ªßy bi·ªÉu ƒë·ªì c≈© n·∫øu t·ªìn t·∫°i
    if (charts[canvasId]) {
        charts[canvasId].destroy();
    }

    // T·∫°o bi·ªÉu ƒë·ªì m·ªõi v√† l∆∞u v√†o charts
    charts[canvasId] = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Hi·ªán t·∫°i', 'Ng∆∞·ª°ng Trung B√¨nh'],
            datasets: [{
                label: label,
                data: data,
                backgroundColor: backgroundColor,
            }],
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'top' },
                title: { display: true, text: `So S√°nh ${label}` },
            },
        },
    });
}

function updateChart(currentData, averageData) {
    const canvas = document.getElementById("comparison-chart");
    if (!canvas) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ canvas.");
        return;
    }

    const ctx = canvas.getContext("2d");

    // Ph√° h·ªßy bi·ªÉu ƒë·ªì c≈© n·∫øu t·ªìn t·∫°i
    if (comparisonChart) {
        comparisonChart.destroy();
    }

    // T·∫°o bi·ªÉu ƒë·ªì m·ªõi v·ªõi d·ªØ li·ªáu ng∆∞·ª°ng t√πy ch·ªânh
    comparisonChart = new Chart(ctx, {
        type: "bar",
        data: {
            labels: ["CTR", "CR", "CPP", "ROI", "Fee Ads"],
            datasets: [
                {
                    label: "Hi·ªán T·∫°i",
                    data: [currentData.ctr, currentData.cr, currentData.cpp, currentData.roi, currentData.fee_ads],
                    backgroundColor: "rgba(75, 192, 192, 0.6)",
                    borderColor: "rgba(75, 192, 192, 1)",
                    borderWidth: 1
                },
                {
                    label: "Ng∆∞·ª°ng Trung B√¨nh",
                    data: [averageData.ctr, averageData.cr, averageData.cpp, averageData.roi, averageData.fee_ads],
                    backgroundColor: "rgba(153, 102, 255, 0.6)",
                    borderColor: "rgba(153, 102, 255, 1)",
                    borderWidth: 1
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: "top" },
                title: { display: true, text: "So S√°nh Ch·ªâ S·ªë B√°n h√†ng Hi·ªán t·∫°i v√† Ng∆∞·ª°ng Trung B√¨nh C·ªßa B·∫°n" }
            }
        }
    });
}


     // C·∫≠p nh·∫≠t c√°c bi·ªÉu ƒë·ªì t·∫°i ƒë√¢y
function updateCharts(chartsData) {
    document.querySelector('.section-header').innerText = 'So S√°nh Ch·ªâ S·ªë';
    	// Ki·ªÉm tra d·ªØ li·ªáu truy·ªÅn v√†o
    	console.log("D·ªØ li·ªáu bi·ªÉu ƒë·ªì:", chartsData);

    renderChart('chart-ctr', 'CTR (%)', [chartsData.ctr.current, chartsData.ctr.average], ['#4CAF50', '#FF5722']);
    renderChart('chart-cr', 'CR (%)', [chartsData.cr.current, chartsData.cr.average], ['#2196F3', '#FFC107']);
    renderChart('chart-cpp', 'CPP (USD)', [chartsData.cpp.current, chartsData.cpp.average], ['#9C27B0', '#3F51B5']);
    renderChart('chart-roi', 'ROI (%)', [chartsData.roi.current, chartsData.roi.average], ['#E91E63', '#03A9F4']);
    renderChart('chart-fee', 'Fee Ads (%)', [chartsData.fee_ads.current, chartsData.fee_ads.average], ['#03A9F4', '#FFC107']);


// H√†m g·ªçi backend v√† hi·ªÉn th·ªã bi·ªÉu ƒë·ªì
// C·∫≠p nh·∫≠t hi·ªÉn th·ªã k·∫øt qu·∫£ ph√¢n t√≠ch

    }

function toggleRegisterForm() {
    // ·∫®n form ƒëƒÉng nh·∫≠p
    document.getElementById("login-section").style.display = "none";

    // Hi·ªÉn th·ªã form ƒëƒÉng k√Ω
    document.getElementById("register-section").style.display = "block";
}

function toggleLoginForm() {
    // ·∫®n form ƒëƒÉng k√Ω
    document.getElementById("register-section").style.display = "none";

    // Hi·ªÉn th·ªã l·∫°i form ƒëƒÉng nh·∫≠p
    document.getElementById("login-section").style.display = "block";
}

// H√†m chuy·ªÉn ƒë·ªïi gi·ªØa c√°c form
function toggleForgotPasswordForm() {
    document.getElementById("login-section").style.display = "none";
    document.getElementById("forgot-password-section").style.display = "block";
}

async function loginUser() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!email || !password) {
        alert("Vui l√≤ng nh·∫≠p email v√† m·∫≠t kh·∫©u!");
        return;
    }

    const payload = { email: email, password: password };

    console.log("üì° G·ª≠i y√™u c·∫ßu ƒëƒÉng nh·∫≠p...", payload);

    try {
        const response = await fetch("https://etsyads-backend.onrender.com/etsyads/login/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },  // ‚úÖ ƒê·∫£m b·∫£o g·ª≠i JSON
            body: JSON.stringify(payload)  // ‚úÖ ƒê·∫£m b·∫£o ƒë√∫ng ƒë·ªãnh d·∫°ng JSON
        });

        const result = await response.json();
        console.log("üì© Ph·∫£n h·ªìi t·ª´ server:", result);

        if (response.ok) {
            alert("‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!");
            window.location.href = "./etsyadsAI.html";  // Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang ch√≠nh
        } else {
            alert(`‚ùå L·ªói ƒëƒÉng nh·∫≠p: ${result.detail || "Kh√¥ng th·ªÉ ƒëƒÉng nh·∫≠p."}`);
        }
    } catch (error) {
        console.error("‚ùå L·ªói khi ƒëƒÉng nh·∫≠p:", error);
        alert("ƒê√£ x·∫£y ra l·ªói, vui l√≤ng th·ª≠ l·∫°i.");
    }
}


</script>
<!-- Ch√®n JavaScript t·ª´ th∆∞ m·ª•c static -->
<script src="static/script.js"></script>

<footer style="display: flex; justify-content: center; align-items: center; width: 100%; position: relative; bottom: 0; padding: 10px 0;">
    <p>¬© 2025 LeLifeAI. All rights reserved.</p>
</footer>

</body>
</html>
