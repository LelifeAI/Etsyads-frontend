<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>LeLife-Etsyads-AI</title>

    <!-- Chèn CSS từ thư mục static -->
	<link rel="stylesheet" href="static/style.css">
        <script src="/static/js/script.js"></script>

    <style>
   

  body {
        	font-family: 'Arial', sans-serif;
       	 	background-color: #f4f4f9;
        	margin: 0;
        	padding: 0;
                padding-top: 110px; /* Đẩy nội dung xuống để không bị che bởi header */
		font-size: 16px; /* Cỡ chữ cơ bản */
   		line-height: 1.5; /* Dòng chữ thoáng hơn */

    }

h1, h2 {
    margin-top: 25px; /* Tạo khoảng cách phía trên tiêu đề */
    margin-bottom: 10px; /* Khoảng cách phía dưới tiêu đề */
}


html, body {
    max-width: 100%; /* Giới hạn chiều rộng */
    overflow-x: hidden; /* Ngăn cuộn ngang */
}
  
   
.container {
    display: flex;
    align-items: center;
    margin: 20px auto; /* Giảm khoảng cách bên ngoài */
    width: 90%; /* Đảm bảo container chiếm tối đa 90% chiều rộng màn hình */
    padding: 1rem; /* Padding linh hoạt */
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    box-sizing: border-box; /* Đảm bảo padding không ảnh hưởng đến kích thước tổng */
    z-index: 1; /* Đặt ưu tiên thấp hơn menu */
    position: relative; /* Đặt container trong ngữ cảnh riêng */
    word-wrap: break-word; /* Bẻ dòng nếu cần */
    max-width: 1400px; /* Giới hạn chiều rộng để gọn hơn */
    margin-top: 20px; /* Đẩy nội dung xuống để không bị che */


}

/* Đảm bảo nội dung chính không che menu */
	.input-section,
	.result-section,
	.chart-section {
  	  position: relative;
 	   z-index: 1;
}

/* Căn chỉnh các thẻ div và section bên trong */
.input-section, .result-section, .chart-section, .threshold-section {
    margin-bottom: 10px;
    padding: 10px;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box; /* Đảm bảo padding không làm thay đổi kích thước phần tử */
}
        
.flex-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
}
       
 .section-header {
    	 	font-size: 1.2rem; /* Kích thước chữ */
    		font-weight: bold; /* In đậm chữ */
   	 	color: #000 !important; /* Đổi màu chữ sang đen và ưu tiên áp dụng */
    		margin-bottom: 5px; /* Khoảng cách dưới */
   	 	text-align: center; /* Căn giữa văn bản */
		z-index: 1; /* Đảm bảo không chồng lấn lên dropdown */
	        position: relative; /* Giữ header nằm trong container */
}

        
label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }

        input[type="text"], input[type="number"], input[type="date"] {
    width: calc(100% - 20px);
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 16px;
}

/* Chỉnh phần nút bấm */
.button {
    background-color: #4caf50;
    color: white;
    padding: 12px 20px;
    margin-top: 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    margin-left: 10px; /* Thêm khoảng cách với cạnh trái */
}

        .button:hover {
            background-color: #45a049;
        }
        .results, .proposals {
            padding: 15px;
            background-color: #f1f1f1;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .chart-container {
		text-align: center;
    		margin-top: 30px;        
}

        .chart {
            width: 100%;
            max-width: 500px;
            margin: auto;
        }
        .row {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 20px;
	    padding-left: 20px; /* Thêm padding vào bên trái */
            padding-right: 20px; /* Thêm padding vào bên phải */
        }
        .row label {
            flex: 1;
            margin-right: 10px; /* Thêm khoảng cách giữa label và input */
        }
        .row input {
            flex: 2;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 100%;;
        }

.row div {
    margin-bottom: 0px;
    padding: 10px;
}

.row div label {
    display: block;
    font-weight: bold;
    margin-bottom: 0px;
}


/* Căn chỉnh các phần nhập dữ liệu */
.threshold-inputs {
   display: flex;
    justify-content: space-between;
    gap: 15px;
    margin-top: 20px;
    padding-left: 20px;
    padding-right: 20px;
}
.chart-section {
    margin-top: 20px;
    text-align: center;
}

.section-header {
    font-size: 1.5rem;
    color: #4CAF50;
    margin-bottom: 5px;
}

body {
    font-family: Arial, sans-serif;
    background-color: #f3f4f6;
    color: #333;
}

img {
    max-width: 100%;
    height: auto;
    display: block; /* Loại bỏ khoảng trắng dưới hình ảnh */
}

.header-container {
    display: flex;
    align-items: center;
    justify-content: space-between; /* Giữ menu bên phải */
    padding: 10px 20px;
    background-color: black; /* Màu nền */
}

header {
    position: fixed; /* Cố định header trên cùng */
    top: 0; /* Đặt ở vị trí đầu trang */
    left: 0; /* Căn trái */
    width: 100%; /* Chiếm toàn bộ chiều ngang */
    z-index: 1000; /* Đảm bảo header hiển thị trên mọi phần tử khác */
    background-color: black; /* Màu nền */
    color: white; /* Màu chữ */
    padding: 5px 15px; /* Tạo khoảng cách bên trong */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Tạo hiệu ứng đổ bóng */
    justify-content: space-between; /* Căn đều khoảng cách giữa các nút */
    align-items: center;

}

@keyframes moveLogo {
    0% { transform: translateX(0); } /* Vị trí ban đầu */
    50% { transform: translateX(20px); } /* Dịch sang phải */
    100% { transform: translateX(0); } /* Quay lại ban đầu */
}

.logo img {
        height: 80px;
	animation: moveLogo 3s infinite ease-in-out; /* Lặp vô hạn */

}

/* Header */
header h1 {
    text-align: center;
    padding: 10px;
    background-color: #333;
    color: white;
    margin: 0;
    font-size: 24px;
}


.input-section {
    display: flex; /* Sử dụng flex để căn chỉnh nội dung */
    justify-content: center; /* Căn giữa nội dung theo chiều ngang */
    align-items: center; /* Căn giữa nội dung theo chiều dọc */
    margin: 10px auto; /* Giảm khoảng cách ngoài để khung gọn hơn */
    padding: 5px 15px; /* Giảm padding để phù hợp với nội dung */
    max-width: fit-content; /* Đảm bảo khung vừa với nội dung */
    background-color: #f9f9f9; /* Màu nền */
    border-radius: 8px; /* Bo góc */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Tạo đổ bóng */
    text-align: center; /* Căn giữa văn bản */
    font-size: 1.2rem; /* Cỡ chữ phù hợp */
    font-weight: bold; /* In đậm văn bản */
    color: #4CAF50; /* Màu chữ */
    box-sizing: border-box; /* Đảm bảo padding không làm thay đổi kích thước */
}


.input-section, .result-section, .chart-section {
    margin-bottom: 30px;
}

.button {
    background-color: #4caf50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
}

.button:hover {
    background-color: #45a049;
}

.results, .proposals {
    background-color: #f9f9f9;
    border-radius: 8px;
    padding: 15px;
    margin-top: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.chart-container {
    text-align: center;
    margin-top: 20px;
}

.flex-container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    gap: 20px;
}


input[type="number"], input[type="text"] {
    padding: 10px;
    border-radius: 5px;
    border: 1px solid #ccc;
    width: calc(100% - 24px);
    margin-bottom: 10px;
    font-size: 16px;
}

.notification {
    background-color: #4caf50;
    color: white;
    padding: 15px;
    border-radius: 5px;
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}

#change-password-form {
    display: none;
}

#show-change-password-btn {
    display: block;
}

.show-form #change-password-form {
    display: block;
}


.content-section {
        margin: 20px;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    .button {
        background-color: #4CAF50;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .button:hover {
        background-color: #45a049;
    }

/* Đặt menu ở chính giữa trang */
nav {
    position: absolute; /* Cho phép điều chỉnh vị trí bằng top và left */
    top: 50%; /* Căn giữa theo chiều dọc */
    left: 50%; /* Căn giữa theo chiều ngang */
    transform: translate(-50%, -50%); /* Điều chỉnh tâm về chính giữa */
}

/* Vị trí nút Demos */
/* Chỉnh kích thước và căn chỉnh menu dropdown */
/* Căn giữa và cố định vị trí các nút trong menu */
.nav-bar {
    display: flex;
    flex-wrap: nowrap;
    justify-content: flex-end; /* Giữ các nút về bên phải */
    align-items: center;
    list-style: none;
    padding: 0;
    white-space: nowrap;
    overflow: hidden;
    color: white;
    gap: 0px; /* Đang là 0px */
    padding-right: 0px; /* Điều chỉnh nếu muốn dịch phải */
    margin-left: 10px; /* Dịch sang phải */
}

/* Chỉnh khoảng cách giữa Lelife và Demos */
.nav-bar li {
    margin: 0 5px; /* Khoảng cách giữa các nút */
    flex-shrink: 1; /* Cho phép các nút co giãn khi không đủ không gian */
    list-style: none;
    display: inline-block;
}

.nav-bar li:nth-child(3) { /* Áp dụng cho mục Tài Liệu */
    margin-left: 20px;
}

.nav-bar a {
    display: inline-block;
    text-decoration: none; /* Bỏ gạch chân */
    font-size: 0.5rem; /* Cỡ chữ mặc định */
    color: white; /* Màu chữ */
    padding: 8px 12px; /* Khoảng cách bên trong nút */
    white-space: nowrap; /* Ngăn chữ ngắt dòng */
    border-radius: 5px; /* Bo góc nút */
    background-color: #4CAF50; /* Màu nền nút */
    text-align: center;
    flex-shrink: 1; /* Thu nhỏ nút nếu không đủ không gian */
    min-width: 100px; /* Chiều rộng tối thiểu của nút */
    max-width: 110px; /* Giới hạn chiều rộng tối đa */
    overflow: visible; /* Ngăn chữ tràn ra ngoài */
    text-overflow: clip; /* Thêm dấu "..." nếu chữ quá dài */
    margin: 0 1px; /* Giảm khoảng cách giữa các button */
    box-sizing: border-box; /* Đảm bảo padding không làm tăng kích thước button */

}

.nav-bar a:hover {
    background-color: #45a049; /* Màu khi rê chuột vào */
}

.nav-bar li:nth-child(2) { /* Áp dụng cho nút Demos */
    margin-left: 20px; /* Tăng khoảng cách bên trái */
}

img {
    max-width: 100%;
    height: auto;
    display: block; /* Loại bỏ khoảng trắng dưới hình ảnh */
}

html, body {
    max-width: 100%; /* Giới hạn chiều rộng */
    overflow-x: hidden; /* Ngăn cuộn ngang */
    transform: scale(1);
    transform-origin: top left;
}

/* Responsive: Tối ưu khoảng cách trên màn hình nhỏ */
/* Responsive adjustments */
@media (max-width: 768px) {

.dropdown-menu {
        flex-direction: column; /* Hiển thị các button theo chiều dọc */
	position: static; /* Hiển thị menu dưới button */
        box-shadow: none; /* Loại bỏ đổ bóng */
        border: none; /* Loại bỏ viền */
	min-width: 150px; /* Độ rộng tối thiểu để chữ không bị cắt */
    }

nav-bar {
        flex-direction: row; /* Hiển thị các button theo chiều dọc */
        align-items: flex-start; /* Căn trái các button */
        padding: 10px; /* Giảm padding */
        gap: 5px; /* Giảm khoảng cách giữa các button */
    }

    .nav-bar a {
        font-size: 0.9rem; /* Giảm cỡ chữ */
        padding: 6px 10px; /* Giảm padding */
	width: 90%; /* Button chiếm toàn bộ chiều rộng */
        min-width: 100px; /* Giảm chiều rộng tối thiểu nếu cần */
        margin: 5px 0; /* Khoảng cách giữa các button */
        text-align: left; /* Căn trái chữ trong button */
	flex-shrink: 0; /* Ngăn button bị thu nhỏ quá mức */
    }
}

@media (max-width: 480px) {
    .nav-bar a {
        font-size: 0.8rem; /* Tiếp tục giảm kích thước chữ */
        padding: 5px 10px; /* Giảm thêm padding */
    }
}

.auth-links a {
    color: white;
    font-weight: bold;
    margin-left: 1050px;
}

.auth-links a:hover {
    color: #4CAF50;
}

/* Nút Demos */
.nav-bar li a {
    display: block;
    color: #333; /* Màu chữ tối */
    background-color: #f7f7f7;
    text-align: center;
    padding: 12px 14px;
    border-radius: 5px;
    text-decoration: none;
    font-size: 16px;
    font-weight: bold;

}

.nav-bar li a:hover {
    color: #000; /* Màu chữ khi rê chuột vào */
    background-color: #575757; /* Màu nền khi rê chuột */}

/* Căn chỉnh nút Đăng nhập/Đăng ký */
.auth-buttons {
    margin-left: auto;
    display: flex;
    gap: 10px;
}

.auth-buttons a {
    background-color: #4caf50;
    color: white;
    padding: 8px 12px;
    text-decoration: none;
    border-radius: 5px;
    font-size: 14px;
    transition: background-color 0.3s ease;
}

.auth-buttons a:hover {
    background-color: #45a049;
}


/* Hiển thị dropdown khi rê chuột hoặc click */
.dropdown:hover .dropdown-menu,
.dropdown.open .dropdown-menu {
    display: block;
    z-index: 9999; /* Menu con luôn nằm trên các thành phần khác */

}

/* Menu con */
.dropdown-menu {
    display: none;    /* Ẩn menu mặc định */
    position: absolute; 	/* Đảm bảo menu xuất hiện tại vị trí cố định */
    top: 100%; 	/* Đặt menu ngay bên dưới mục "Demos" */
    right: 20;
    left: 15px; /* Di chuyển vào bên trái một chút */
    background-color: #ffffff;
    border: 1px solid #ddd;
    border-radius: 5px;
    min-width: 130px; /* Chiều rộng tối thiểu */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    z-index: 9999; /* Ưu tiên hiển thị cao nhất */
    padding: 4px 5px; /* Chỉnh độ rộng cho dropdown menu */
    max-width: 100%; /* Giới hạn chiều rộng tối đa */
    flex-direction: column; /* Hiển thị theo chiều dọc */

}

.dropdown-menu * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}


/* Dropdown items */
.dropdown-menu li a {
    color: #333;
    padding: 5px 10px;
    font-size: 0.9rem;
    text-decoration: none;
    display: block;
    background-color: transparent; /* Nền trong suốt */
    margin: 0; /* Loại bỏ khoảng cách không cần thiết */
    width: 100%; /* Đảm bảo chiều ngang đồng đều */
    min-width: 100px; /* Chiều rộng tối thiểu */
    text-align: left; /* Căn chữ về bên trái */
   

}

.dropdown-menu li a:hover {
    background-color: #f0f0f0; /* Hiển thị nền khi hover */
    color: #000; /* Màu chữ khi hover */

}

/* About Section Styling */
#about-section {
    padding: 20px;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin: 20px auto;
    max-width: 800px;

}

/* Chỉ định ảnh trong trang Giới Thiệu */
#about-section .profile-picture {
    display: flex;
    justify-content: center; /* Căn giữa nội dung */
    margin-top: 20px;
}

#about-section .profile-picture img {
    width: 180px;
    height: 180px;
    border-radius: 50%;
    border: 4px solid #4CAF50;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}


/* Styling cho About Section */
.about-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: #ffffff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin: 20px auto;
    max-width: 800px;
}

.profile-picture img {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    border: 4px solid #4CAF50;
    object-fit: cover;
}

.about-content {
    flex: 1;
    margin-left: 20px;
}

.about-content h2 {
    color: #333;
    font-size: 24px;
    margin-bottom: 10px;
}

.about-content p {
    font-size: 16px;
    color: #555;
    line-height: 1.5;
}

/* Show dropdown on hover */
.dropdown:hover .dropdown-menu {
    display: block;
}


/* Nội dung chính chỉnh z-index thấp hơn dropdown */
.input-section {
    margin-bottom: 30px;
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

   /* Chỉnh lại bảng dữ liệu */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    padding: 12px;
    text-align: left;
    border: 1px solid #ddd;
}

th {
    background-color: #f4f4f4;
}


#login-section, #change-password-section {
    margin: 20px 0;
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    z-index: 10; /* Hiển thị trên các phần khác nếu cần */

}

.action-buttons {
    display: flex;
    justify-content: center; /* Căn giữa theo chiều ngang */
    margin-top: 20px; /* Thêm khoảng cách phía trên */
    gap: 15px; /* Khoảng cách giữa 2 nút */
}

.action-buttons button {
    padding: 12px 24px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background-color: #4caf50;
    color: white;
    transition: background-color 0.3s ease;
}

.action-buttons button:hover {
    background-color: #45a049;
}

.submenu-list {
    left: calc(100% - 20px); /* Dịch menu con sang trái 20px */
}

.submenu-list li a {
    padding-left: 10px; /* Thêm khoảng cách bên trái cho text */
}

.fixed-title {
    position: fixed; /* Đặt tiêu đề cố định */
    top: 10px; /* Cách phía trên 10px */
    left: 10px; /* Cách bên trái 10px */
    margin: 0; /* Loại bỏ margin mặc định */
    font-size: 1rem; /* Cỡ chữ phù hợp */
    font-weight: bold; /* In đậm tiêu đề */
    color: black; /* Màu chữ xanh lá */
    background-color: white; /* Nền trắng cho dễ nhìn */
    padding: 5px 15px; /* Tạo khoảng cách bên trong cho tiêu đề */
    border-radius: 5px; /* Bo góc nhẹ */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Tạo đổ bóng nhẹ */
    z-index: 1000; /* Đảm bảo tiêu đề luôn nằm trên các phần tử khác */
}

.section-header.highlight {
background: linear-gradient(135deg, #ffffff, #f5f5f5); /* Trắng pha xám sáng nhẹ */
    color: white; /* Màu chữ nổi bật */
    padding: 5px; /* Khoảng cách hợp lý */
    margin: 5px auto; /* Khoảng cách trên dưới */
    font-size: 1.5rem; /* Kích thước chữ lớn để thu hút */
    font-weight: bold; /* Chữ in đậm */
    text-align: center; /* Căn giữa văn bản */
    border-radius: 12px; /* Bo góc mềm mại */
    max-width: 1200px; /* Giới hạn chiều rộng */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); /* Tạo chiều sâu cho chữ */
    animation: fadeIn 1s ease-out; /* Hiệu ứng xuất hiện */
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}



    </style>

</head>

<header>

    <div id="notification" style="display: none;" class="notification">
        <p id="notification-message"></p>
    </div>

    <div class="header-container">
        <div class="logo">
            <img src="static/images/logo.png" alt="Logo">
    </div>
 
   <!-- Menu Điều Hướng -->
<nav>
    <ul class="nav-bar">
        <!-- Menu LeLife -->
        <li class="dropdown">
            <a href="#" id="lelifetoggle">LeLife ▼</a>
            <ul class="dropdown-menu" id="lelifemenu">
                <li><a href="./index.html" onclick="showSection('about-ai-section')">Giới thiệu</a></li>
		<li><a href="#" onclick="showSection('login-section')">Đăng Nhập</a></li>
            </ul>
        </li>

        <!-- Menu Demos -->
        <li class="dropdown">
            <a href="#" id="demostoggle">Demos ▼</a>
            <ul class="dropdown-menu" id="demosmenu">
                <!-- EtsyAds-AI -->
                <li class="submenu">
                    <a href="./etsyadsai.html" onclick="showSection('etsyads-ai-section')">EtsyAds-AI ▼</a>
                    <ul class="submenu-list">
                        <li><a href="#" onclick="showSection('history-section')">Lịch Sử Phân Tích</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <!-- Menu Hướng Dẫn -->
        <li class="dropdown">
    		<a href="#" id="guidetoggle">Hướng dẫn ▼</a>
    		<ul class="dropdown-menu" id="guidemenu">
       	 		<li><a href="./sach.html" onclick="showSection('sach-ai-section')">Sách</a></li>
        		<li><a href="./coaching.html" onclick="showSection('coaching-section')">Coaching</a></li>
       			<li><a href="./congcu.html" onclick="showSection('congcu-section')">Công Cụ</a></li>
    		</ul>
	</li>
    </ul>
</nav>


</header>

    
<body>

<div class="container">
    <div class="input-section">
<div class="section-header highlight"> EtsyAds-AI – Tool AI tự động xử lý ads, do LeLifeAI tạo ra. Website này cũng là sản phẩm từ chính AI!</div>

<section id="login-section" class="content-section">  <!-- Ẩn mặc định -->
    <div class="login-section">
        <h3>Đăng Nhập</h3>
        <label for="email">Tên Đăng Nhập hoặc Email:</label>
        <input type="text" id="email" placeholder="Nhập tên đăng nhập hoặc email">
        
        <label for="password">Mật Khẩu:</label>
        <input type="password" id="password" placeholder="Nhập mật khẩu">
        <button class="button" onclick="loginUser()">Đăng Nhập</button>
        <button class="button" onclick="toggleRegisterForm()">Đăng Ký</button>
        <button class="button" onclick="toggleForgotPasswordForm()">Quên Mật Khẩu</button> <!-- Nút Quên Mật Khẩu -->
    </div>
</section>

<section id="forgot-password-section" class="content-section" style="display: none;">
    <div class="forgot-password-section">
        <h3>Quên Mật Khẩu</h3>
        <label for="fp-email">Email:</label>
        <input type="email" id="fp-email" placeholder="Nhập email để lấy lại mật khẩu">
        <button class="button" onclick="sendResetPasswordEmail()">Gửi Email Khôi Phục</button>
        <button class="button" onclick="toggleLoginForm()">Quay Lại</button>
    </div>
</section>

<div id="reset-password-section" style="display: none;">
    <h3>Đặt lại mật khẩu</h3>
    <label for="new-password">Mật khẩu mới:</label>
    <input type="password" id="new-password" placeholder="Nhập mật khẩu mới">
    <button onclick="submitResetPassword()">Đặt lại mật khẩu</button>
</div>

<form id="reset-password-form" style="display: none;">
    <label for="new-password">Mật khẩu mới:</label>
    <input type="password" id="new-password" placeholder="Nhập mật khẩu mới">
    <button type="button" onclick="submitResetPassword()">Đặt lại mật khẩu</button>
</form>

<section id="register-section" class="content-section" style="display: none;">
    <div class="register-section">
        <h3>Đăng Ký</h3>
        <label for="reg-username">Tên Đăng Nhập:</label>
        <input type="text" id="reg-username" placeholder="Nhập tên đăng nhập">

        <label for="reg-email">Email:</label>
        <input type="email" id="reg-email" placeholder="Nhập email của bạn">

        <label for="reg-password">Mật Khẩu:</label>
        <input type="password" id="reg-password" placeholder="Nhập mật khẩu">

        <button class="button" onclick="registerUser()">Đăng Ký</button>
        <button class="button" onclick="toggleLoginForm()">Quay Lại</button> <!-- Nút Quay Lại -->
    </div>
</section>


<section id="about-section" class="content-section" style="display: none;">
    <div class="profile-picture">
        <img src="/static/images/profile.jpg" alt="Ảnh của bạn" style="border-radius: 50%; width: 180px; height: 180px;">
    </div>
    <h2>Giới Thiệu</h2>
    <p>Chào mừng bạn đến với LeLifeAI! Đây là nơi tôi chia sẻ các công cụ AI và kinh doanh online.</p>
    <p> <strong>Tôi là LeLife, người sáng lập LeLifeAI.</strong></p>
 <p>LeLife có thể hiểu là "Lẽ Sống", hoặc "Cuộc Đời Onlne", hoặc "Cuộc Sống Của Le". giải thích theo nghĩa nào cũng đều có góc nhìn hay của nó! Phải mất mấy chục năm trời mới tìm được Chân lý của đời mình. Đó là kinh doanh online....</p>
<p> Khởi nguồn từ lòng đam mê và trải nghiệm của bản thân trong lĩnh vực kiếm tiền online suốt 10 năm qua, tôi muốn chia sẻ các cách làm có thể giúp người bán hàng đạt được hiệu quả cao nhất từ việc đăng sản phẩm, nghiên cứu sản phẩm hay các chiến dịch quảng cáo trên các marketplaces.</p>
<p> Với sự phát triển của AI, với nền tảng là một engineer, và cũng là một người "Thích online", tôi đã nghiên cứu ra các công cụ AI để giúp công việc kinh doanh của mình hiệu quả hơn, cụ thể là POD, Etsy, Amazon và AI tools
<p><strong>Nếu bạn có bất kỳ câu hỏi nào, đừng ngần ngại liên hệ với tôi qua email: quangleblog@gmail.com, sdt: 094.196.3399 (zalo)</strong>.</p>
<p> <strong> Một số lĩnh vực kiếm tiền online mà tôi đã từng làm hơn 10 năm qua thành công:</strong></p>

<p> Ngành online 1: Bán hàng POD trên Etsy.</p>

<p> Ngành online 2: Bán hàng POD trên eBay.</p>

<p> Ngành online 3: Bán hàng POD trên Amazon.</p>

<p> Ngành online 4: Bán quần áo trên Merch By Amazon.</p>

<p> Ngành online 5: Kiếm tiền online tại nhà bằng nghề Freelance tester.</p>

<p> Ngành online 6: Bán sách trên Amazon Kindle.</p>

<p> Ngành online 7: Phát hành sách bán trong nhà sách Việt Nam. </p>

<p> Ngành online 8: Kiếm tiền bằng nhận quảng cáo từ Youtube. </p>

<p> Ngành tay trái 9: Coaching Online bằng cách xây dựng thương hiệu trên Youtube. </p>

<p> Ngành tay trái 10: Kiếm tiền qua xây dựng các khoá học trên Udemy. </p>

<p> Ngành tay trái 11: Kiếm tiền cách làm Affiliate Marketing. </p>

<p>Trong đó, bán hàng POD trên Etsy, Amazon là phương pháp mang lại thu nhập cao. </p>


<p>Về mảng POD, tôi có 7 năm kinh nghiệm làm kinh doanh POD trên nhiều nền tảng khác nhau như Amazon, Etsy và eBay. Trong đó, Etsy là nền tảng kinh doanh thành công nhất với Doanh thu hơn <strong> 250.000$ trong 2 năm.</strong> </p>

<p>Từ thành công đó, tôi đã chia sẻ kiến thức của mình trên nhiều nền tảng khác nhau như Udemy, Youtube...được rất nhiều người ủng hộ. </p>

<p>Tôi có viết sách về Etsy: " Cách Bán Hàng Trên Sàn Etsy Từ A-Z | Bí quyết khởi nghiệp với ngân sách nhỏ" đang bán ở nhà sách Fahasa, Tiki, Lazada... Và Amazon Kindle. </p>
<p>▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬</p>
<p>  <i>►MUA SÁCH ETSY</strong></i></p>
<p>  <i>Liên hệ: 094.196.3399 (zalo)</i></p>
<p>  <i>STK: 19035211449011 (Techcombank)</i></p>
<p>  <i>Nội dung chuyển khoản: Họ tên + Mua sách Etsy</i></p>
<p>  <i>Cách nhận sách: Gửi Họ tên, địa chỉ và số điện thoại người nhận qua Zalo</i></p>
<p>▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬</p>
<p>  <i>► HỖ  TRỢ COACHING POD, ETSY, AMAZON:</i></p>
<p>  <i>+ SDT: 0941963399 (ZALO)</i></p>
<p>  <i>+  Facebook:   quang.leduy.9843  </i></p>
<p>  <i>+ Học phí: liên hệ</i></p>
<p>▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
</div>
    </div>
</section>

<section id="change-password-section" class="content-section" style="display:none;">
    <div class="auth-section">
        <h3>Đổi mật khẩu</h3>
        <label for="username">Tên người dùng:</label>
        <input type="text" id="username" placeholder="Nhập tên người dùng">
        <label for="old-password">Mật khẩu cũ:</label>
        <input type="password" id="old-password" placeholder="Nhập mật khẩu cũ">
        <label for="new-password">Mật khẩu mới:</label>
        <input type="password" id="new-password" placeholder="Nhập mật khẩu mới">
        <button onclick="changePassword()">Đổi mật khẩu</button>
    </div>
</section>

<section id="user-list-section" class="content-section" style="display:none;">
    <div id="user-list">
        <h3>Danh sách người dùng</h3>
        <ul id="users"></ul>
    </div>
</section>

<section id="admin-dashboard" class="content-section" style="display: none;">
    <h3>Admin Dashboard - Quản Lý Người Dùng</h3>
    <table id="user-table" border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Tên Người Dùng</th>
                <th>Hành Động</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>


<section id="history-section" class="content-section" style="display: none;">
    <h3>Lịch Sử Phân Tích</h3>
    
    <!-- Thêm canvas cho biểu đồ -->
    <canvas id="historyChart" style="max-width: 100%; margin-bottom: 20px;"></canvas>
    
    <!-- Bảng dữ liệu phân tích -->
    <table id="history-table" border="1">
        <thead>
            <tr>
                <th>Thời Gian</th>
                <th>CTR (%)</th>
                <th>CR (%)</th>
                <th>CPP (USD)</th>
                <th>ROI (%)</th>
                <th>Fee Ads (%)</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <button class="button" onclick="deleteHistory()">Xóa Lịch Sử</button>
</section>


        <!-- Thời gian chạy ads -->
        <div class="row">
            <label>Chọn thời gian phân tích ads:</label>
            <div>
                <label for="start-date">Bắt đầu:</label>
                <input type="date" id="start-date" required>
            </div>
            <div>
                <label for="end-date">Kết thúc:</label>
                <input type="date" id="end-date" required>
            </div>
        </div>

        <!-- Các chỉ số quảng cáo -->
        <div class="row">
            <div>
                <label for="views">Lượt xem:</label>
                <input type="number" id="views" placeholder="Nhập số lượt xem">
            </div>
            <div>
                <label for="clicks">Lượt nhấp chuột:</label>
                <input type="number" id="clicks" placeholder="Nhập số lượt nhấp">
            </div>
            <div>
                <label for="orders">Đơn hàng:</label>
                <input type="number" id="orders" placeholder="Nhập số đơn hàng">
            </div>
            <div>
                <label for="revenue">Doanh thu (USD):</label>
                <input type="number" id="revenue" placeholder="Nhập doanh thu">
            </div>
            <div>
                <label for="spend">Chi phí quảng cáo (USD):</label>
                <input type="number" id="spend" placeholder="Nhập chi phí quảng cáo">
            </div>

        </div>

        <!-- Thời gian bán hàng -->
        <div class="row" style="margin-top: 20px;">
            <label> Doanh Thu&Chi phí theo khung thời gian:</label>
            <div>
                <label for="sales-start-date">Bắt đầu:</label>
                <input type="date" id="sales-start-date" required>
            </div>
            <div>
                <label for="sales-end-date">Kết thúc:</label>
                <input type="date" id="sales-end-date" required>
            </div>
        </div>

        <!-- Các chỉ số bán hàng -->
        <div class="row">
            <div>
                <label for="sales">Doanh thu(USD):</label>
                <input type="number" id="sales" placeholder="Sales">
            </div>
            <div>
                <label for="marketing">Chi phí MKT(USD):</label>
                <input type="number" id="marketing" placeholder="Marketing">
            </div>
            <div>
                <label for="fees">Phí Etsy(USD):</label>
                <input type="number" id="fees" placeholder="Phí">
            </div>
        </div>


<!-- Ngưỡng Giá Trị Trung Bình (Tuỳ Chọn) -->
<div class="threshold-section">
    <h3>Ngưỡng Giá Trị Trung Bình (Tuỳ Chọn)</h3>
    <div class="threshold-inputs">
        <div>
            <label for="ctr-threshold">CTR (%):</label>
            <input type="number" id="ctr-threshold" placeholder="2" value="2">
        </div>
        <div>
            <label for="cr-threshold">CR (%):</label>
            <input type="number" id="cr-threshold" placeholder="2.5" value="2.5">
        </div>
        <div>
            <label for="cpp-threshold">CPP (USD):</label>
            <input type="number" id="cpp-threshold" placeholder="10" value="10">
        </div>
        <div>
            <label for="fee-ads-threshold">Fee Ads (%):</label>
            <input type="number" id="fee-ads-threshold" placeholder="20" value="20">
        </div>
        <div>
            <label for="roi-threshold">ROI (%):</label>
            <input type="number" id="roi-threshold" placeholder="75" value="75">
        </div>
    </div>
</div>

    </div>

<div class="action-buttons">
    <button id="analyze-button" onclick="analyzeData()">Phân tích</button>
</div>

<div class="result-section">
    <h3 class="section-header">Kết Quả Phân Tích</h3>
    <div id="analysis-results" class="results">
        Chưa có dữ liệu phân tích.
    </div>

        <div class="section-header">Đề Xuất Hành Động</div>
        <div class="proposals">
            <p id="proposals">Các đề xuất sẽ hiển thị ở đây...</p>
        </div>
    </div>

<div class="action-buttons">
    <button id="save-history" onclick="saveHistory()">Lưu Kết Quả</button>
</div>


  <div class="chart-section">
    <h3 class="section-header">Biểu Đồ So Sánh</h3>
    <div class="chart-container">
        <canvas id="comparison-chart" class="chart" style="max-width: 800px; margin: auto;"></canvas>
    </div>
</div>

    <div class="flex-container">
        <canvas id="chart-ctr" class="chart"></canvas>
        <canvas id="chart-cr" class="chart"></canvas>
        <canvas id="chart-cpp" class="chart"></canvas>
        <canvas id="chart-fee" class="chart"></canvas>
        <canvas id="chart-roi" class="chart"></canvas>
        <canvas id="historyChart"></canvas>
    </div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const API_URL = "http://127.0.0.1:8000/etsyads";

// Kiểm tra URL có chứa token không
 document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");
    const resetForm = document.getElementById("reset-password-form");

    console.log("🔍 Trang hiện tại:", window.location.pathname);

    // ✅ Chỉ kiểm tra token nếu đang ở reset-password.html
    if (!window.location.pathname.includes("reset-password.html")) {
        console.log("✅ Không phải trang reset-password, bỏ qua kiểm tra token.");
        return;
    }

    console.log("🔍 Token từ URL:", token);

    if (!token) {
        console.warn("⚠️ Không tìm thấy token. Ẩn form đặt lại mật khẩu.");
        if (resetForm) resetForm.style.display = "none";
        alert("Không tìm thấy token hợp lệ. Vui lòng thử lại.");
    } else {
        console.log("✅ Token hợp lệ, hiển thị form đặt lại mật khẩu.");
        if (resetForm) resetForm.style.display = "block";
    }
});



//Hiển thị thông báo
function showNotification(message, type = 'success') {
    const notification = document.getElementById('notification');
    const messageElement = document.getElementById('notification-message');
    
    messageElement.textContent = message;
    notification.style.backgroundColor = type === 'success' ? '#4caf50' : '#f44336';
    notification.style.display = 'block';

    setTimeout(() => {
        notification.style.display = 'none';
    }, 3000);
}

// Hàm đăng ký người dùng
async function registerUser() {
    const username = document.getElementById("reg-username").value.trim();
    const email = document.getElementById("reg-email").value.trim();
    const password = document.getElementById("reg-password").value.trim();

    if (!username || !email || !password) {
        alert("Vui lòng điền đầy đủ thông tin!");
        return;
    }

    const payload = {
        username: username,
        email: email,
        password: password,
    };

    console.log("Dữ liệu gửi đi:", payload);

    try {
        const response = await fetch(`${API_URL}/register/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
        });

        const result = await response.json();
        if (response.ok) {
            alert("Đăng ký thành công!");
            toggleLoginForm(); // Quay lại form đăng nhập
        } else {
            console.error("Lỗi đăng ký:", result);
            alert(`Lỗi khi đăng ký: ${result.detail}`);
        }
    } catch (error) {
        console.error("Lỗi khi đăng ký:", error);
        alert("Có lỗi xảy ra, vui lòng thử lại.");
    }
}


// Hàm đăng nhập
async function loginUser() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!email || !password) {
        alert("Vui lòng nhập email và mật khẩu!");
        return;
    }

    const payload = {
        email: email,
        password: password
    };

    console.log("📡 Gửi yêu cầu đăng nhập...", payload);

    try {
        const response = await fetch("http://127.0.0.1:8000/etsyads/login/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },  // ✅ Đảm bảo gửi JSON
            body: JSON.stringify(payload)  // ✅ Đảm bảo định dạng đúng
        });

        const result = await response.json();
        console.log("📩 Phản hồi từ server:", result);

        if (response.ok) {
            alert("✅ Đăng nhập thành công!");
            window.location.href = "/static/etsyadsAI.html";
        } else {
            alert(`❌ Lỗi đăng nhập: ${result.detail || "Không thể đăng nhập."}`);
        }
    } catch (error) {
        console.error("❌ Lỗi khi đăng nhập:", error);
        alert("Đã xảy ra lỗi, vui lòng thử lại.");
    }
}

// Hàm gửi email khôi phục mật khẩu
async function sendResetPasswordEmail() {
    const email = document.getElementById("fp-email").value.trim();

    if (!email) {
        alert("Vui lòng nhập email!");
        return;
    }

    const payload = { email: email };

    try {
        const response = await fetch(`${API_URL}/forgot-password/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
        });

        if (response.ok) {
            alert("Email khôi phục đã được gửi!");
        } else {
            const result = await response.json();
            alert(`Lỗi: ${result.detail}`);
        }
    } catch (error) {
        console.error("Lỗi khi gửi email khôi phục:", error);
        alert("Có lỗi xảy ra, vui lòng thử lại.");
    }
}

async function resetPassword() {
    const token = new URLSearchParams(window.location.search).get("token");
    const newPassword = document.getElementById("new-password").value.trim();

    if (!token || !newPassword) {
        alert("Token hoặc mật khẩu không hợp lệ!");
        return;
    }

    try {
        const response = await fetch(`${API_URL}/reset-password/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ token, new_password: newPassword }),
        });

        const result = await response.json();
        if (response.ok) {
            alert("Đặt lại mật khẩu thành công!");
            window.location.href = "/static/login.html";
        } else {
            alert(`Lỗi: ${result.detail}`);
        }
    } catch (error) {
        console.error("Lỗi khi đặt lại mật khẩu:", error);
        alert("Đã xảy ra lỗi. Vui lòng thử lại!");
    }
}


// Hàm lưu trang trước và quay lại
function redirectToPreviousPage() {
    const previousPage = localStorage.getItem("previousPage");
    if (previousPage) {
        window.location.href = previousPage;
    } else {
        window.location.href = "C:/Users/QUANG LE/AppData/Local/Programs/Python/Python313/frontend/etsyadsAI.html"; // Mặc định về trang chủ nếu không tìm thấy trang trước đó
    }
}

// Lưu trang hiện tại trước khi chuyển hướng đến trang đăng nhập/đăng ký
function saveCurrentPage() {
    localStorage.setItem("previousPage", window.location.href);
}

// Gọi hàm khi người dùng truy cập trang đăng nhập/đăng ký
window.onload = function () {
    if (window.location.pathname.includes("login") || window.location.pathname.includes("register")) {
        saveCurrentPage();
    }
};

async function changePassword() {
    const username = document.getElementById('username').value;
    const oldPassword = document.getElementById('old-password').value;
    const newPassword = document.getElementById('new-password').value;

    if (!username || !oldPassword || !newPassword) {
        showNotification("Vui lòng nhập đầy đủ thông tin!", "error");
        return;
    }

    try {
        const response = await fetch(`${API_URL}/change_password/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, old_password: oldPassword, new_password: newPassword }),
        });

        if (response.ok) {
            showNotification("Đổi mật khẩu thành công!", "success");

            // Ẩn phần Đổi Mật Khẩu
            document.getElementById('change-password-section').style.display = 'none';
        } else {
            alert("Lỗi khi đổi mật khẩu.");
        }
    } catch (error) {
        console.error("Lỗi khi đổi mật khẩu:", error);
        alert("Lỗi kết nối. Vui lòng thử lại.");
    }
}

//lấy danh sách người dùng
async function getUsers() {
    try {
        const response = await fetch('/users/');
        const users = await response.json();

        if (Array.isArray(users)) {
            users.forEach(user => {
                console.log(user);
            });
        } else {
            console.error('Dữ liệu không phải là mảng:', users);
        }
    } catch (error) {
        console.error('Lỗi khi lấy dữ liệu người dùng:', error);
    }
}


const element = document.getElementById('some-element');
if (element) {
    element.style.display = 'block';
}

function logoutUser() {
    const token = localStorage.getItem("accessToken");

    if (!token) {
        showNotification("Bạn chưa đăng nhập!", "error");
        return;
    }

//lấy danh sách người dùng
async function fetchUsers() {
    const token = localStorage.getItem("accessToken");
    if (!token) {
        showNotification("Vui lòng đăng nhập!", "error");
        return;
    }

    try {
        const response = await fetch(`${API_URL}/users/`, {
            method: "GET",
            headers: { "Authorization": `Bearer ${token}` }
        });

        if (response.ok) {
            const users = await response.json();
            const userTable = document.querySelector("#user-table tbody");
            userTable.innerHTML = "";

            users.forEach(user => {
                const row = `
                    <tr>
                        <td>${user.id}</td>
                        <td>${user.username}</td>
                        <td><button onclick="deleteUser(${user.id})">Xóa</button></td>
                    </tr>
                `;
                userTable.insertAdjacentHTML('beforeend', row);
            });
        } else {
            const errorData = await response.json();
            showNotification(`Lỗi: ${errorData.detail}`, "error");
        }
    } catch (error) {
        console.error("Lỗi khi tải danh sách người dùng:", error);
        showNotification("Lỗi kết nối. Vui lòng thử lại.", "error");
    }
}


// gửi yêu cầu xóa người dùng qua API
async function deleteUser(userId) {
    const token = localStorage.getItem("accessToken");
    if (!token) {
        showNotification("Vui lòng đăng nhập!", "error");
        return;
    }

    if (!confirm("Bạn có chắc chắn muốn xóa người dùng này?")) return;

    try {
        const response = await fetch(`${API_URL}/users/${userId}`, {
            method: "DELETE",
            headers: { "Authorization": `Bearer ${token}` }
        });

        if (response.ok) {
            showNotification("Xóa người dùng thành công!", "success");
            fetchUsers();  // Làm mới danh sách sau khi xóa
        } else {
            showNotification("Lỗi khi xóa người dùng.", "error");
        }
    } catch (error) {
        console.error("Lỗi khi xóa người dùng:", error);
        showNotification("Lỗi kết nối. Vui lòng thử lại.", "error");
    }
}


    // Gọi API để đăng xuất (nếu backend có hỗ trợ)
    fetch(`${API_URL}/logout/`, { method: "POST", headers: { "Authorization": `Bearer ${token}` } })
        .then(response => {
            if (response.ok) {
                localStorage.removeItem("accessToken");
                showNotification("Đã đăng xuất thành công!", "success");

                // Hiển thị lại form Đăng Nhập
                document.getElementById('login-section').style.display = 'block';
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'none';
                });
            } else {
                showNotification("Lỗi khi đăng xuất!", "error");
            }
        })
        .catch(error => {
            console.error("Lỗi khi đăng xuất:", error);
            showNotification("Lỗi kết nối. Vui lòng thử lại.", "error");
        });
}

document.querySelectorAll('nav a').forEach(link => {
    link.addEventListener('click', event => {
        const target = event.currentTarget;

        // Lấy URL hiện tại
        const currentUrl = window.location.href;

        // Kiểm tra nếu có lặp "frontend/frontend"
        if (currentUrl.includes('frontend/frontend')) {
            // Loại bỏ lặp "frontend/frontend"
            const correctedUrl = currentUrl.replace('/frontend/frontend', '/frontend');
            window.location.href = correctedUrl; // Chuyển hướng về URL chuẩn
        }
    });
});

 
document.addEventListener("DOMContentLoaded", function () {
    console.log("Sự kiện DOMContentLoaded đã chạy.");

    // ✅ Xử lý submenu dropdown
    document.querySelectorAll(".dropdown > a").forEach(function (element) {
        element.addEventListener("click", function (event) {
            event.preventDefault();
            const parentDropdown = this.parentElement;
            parentDropdown.classList.toggle("open");
        });
    });

    // ✅ Đóng menu dropdown khi click ra ngoài
    document.addEventListener('click', function (event) {
    const dropdowns = document.querySelectorAll('.dropdown');
    dropdowns.forEach(function (dropdown) {
        if (!dropdown.contains(event.target) && !event.target.closest('.dropdown-menu')) {
            dropdown.classList.remove('open');
        }
    });
});

    // ✅ Kiểm tra token reset-password mà không ảnh hưởng dropdown
    checkResetToken();
});

// ✅ HÀM KIỂM TRA TOKEN RESET PASSWORD
function checkResetToken() {
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");
    const resetForm = document.getElementById("reset-password-form");

    console.log("🔍 Trang hiện tại:", window.location.pathname);

    // ✅ Chỉ kiểm tra token nếu đang ở reset-password.html
    if (!window.location.pathname.includes("reset-password.html")) {
        console.log("✅ Không phải trang reset-password, bỏ qua kiểm tra token.");
        return;
    }

    console.log("🔍 Token từ URL:", token);

    if (token) {
        token = decodeURIComponent(token);
        console.log("✅ Token hợp lệ, hiển thị form đặt lại mật khẩu.");
        if (resetForm) resetForm.style.display = "block";
    } else {
        console.warn("⚠️ Không tìm thấy token. Ẩn form đặt lại mật khẩu.");
        if (resetForm) resetForm.style.display = "none";
        alert("Không tìm thấy token hợp lệ. Vui lòng thử lại.");
    }
}

function showSection(sectionId) {
    // Ẩn tất cả các section
    const sections = document.querySelectorAll('section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Hiển thị phần được chọn (ví dụ: about-section)
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.style.display = 'block';
    }

    // Nếu chọn "about-section", ẩn tất cả các phần dư thừa khác
    if (sectionId === 'about-section') {
        // Ẩn các thành phần không liên quan
        document.querySelectorAll('.input-section, .result-section, .chart-section, .action-buttons, .threshold-section, .row')
            .forEach(el => el.style.display = 'none');

        // Hiển thị Giới Thiệu
        const aboutSection = document.getElementById('about-section');
        if (aboutSection) {
            aboutSection.style.display = 'block';
        }
    }
}

const charts = {};
let chartInstances = [];
let comparisonChart = null;

// Xử lý sự kiện click vào nút Demos
document.getElementById('demos-toggle').addEventListener('click', function (e) {
    e.preventDefault();
    const menu = document.getElementById('demos-menu');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
});

// Ẩn menu khi click ra ngoài
document.addEventListener('click', function (e) {
    const toggle = document.getElementById('demos-toggle');
    const menu = document.getElementById('demos-menu');

    if (!toggle.contains(e.target) && !menu.contains(e.target)) {
        menu.style.display = 'none';
    }
});

// Kiểm tra trạng thái đăng nhập khi tải trang
document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    let token = urlParams.get("token");

    console.log("🔍 Token từ URL:", token);  // ✅ Debug token

    if (!token) {
        console.warn("⚠️ Không tìm thấy token. Ẩn form đặt lại mật khẩu.");
        document.getElementById("reset-password-form").style.display = "none";
        return;
    }

    // ✅ Nếu có token, hiển thị form đặt lại mật khẩu
    document.getElementById("reset-password-form").style.display = "block";
});

//Gọi hàm này khi người dùng nhấp vào tab Lịch Sử Phân Tích
document.addEventListener("DOMContentLoaded", () => {
    console.log("Trang đã tải xong. Không hiển thị form mặc định.");
    document.querySelector('a[href="#history-section"]').addEventListener('click', fetchHistory);
});

// Hiển thị nút Đăng Xuất nếu người dùng đã đăng nhập
    document.addEventListener("DOMContentLoaded", () => {
        const token = localStorage.getItem("accessToken");
        if (token) {
            document.querySelector('a[href="#logout"]').style.display = 'block';
        } else {
            document.querySelector('a[href="#logout"]').style.display = 'none';
        }
    });


document.addEventListener("DOMContentLoaded", () => {
    const urlParams = new URLSearchParams(window.location.search);
    const section = urlParams.get('section');

    if (section) {
        showSection(section);
    }
});


document.addEventListener("DOMContentLoaded", async () => {
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");

    if (token) {
        try {
            // Gửi yêu cầu kiểm tra token
            const response = await fetch(`http://localhost:8000/reset-password/?token=${token}`, {
                method: "GET",
            });

            if (response.ok) {
                const result = await response.json();
                console.log("Token hợp lệ, hiển thị form đặt lại mật khẩu:", result);

                // Hiển thị form đặt lại mật khẩu
                document.getElementById("reset-password-section").style.display = "block";
            } else {
                throw new Error("Token không hợp lệ");
            }
        } catch (error) {
            console.error("Lỗi khi xác minh token:", error);
            alert("Liên kết đặt lại mật khẩu không hợp lệ hoặc đã hết hạn.");
        }
    } else {
        alert("Token không tồn tại trong URL.");
    }
});


// Hàm lấy lịch sử phân tích
async function fetchHistory() {
    try {
        const response = await fetch(`${API_URL}/history/`);
        if (!response.ok) {
            throw new Error(`Lỗi khi tải lịch sử: ${response.status}`);
        }
        const history = await response.json();

        const historyTable = document.querySelector("#history-table tbody");
        historyTable.innerHTML = "";

        if (history.length === 0) {
            historyTable.innerHTML = "<tr><td colspan='6'>Không có dữ liệu phân tích.</td></tr>";
            return;
        }

        history.forEach(entry => {
            const row = `
                <tr>
                    <td>${new Date(entry.timestamp).toLocaleString()}</td>
                    <td>${entry.ctr.toFixed(2)}%</td>
                    <td>${entry.cr.toFixed(2)}%</td>
                    <td>$${entry.cpp.toFixed(2)}</td>
                    <td>${entry.roi.toFixed(2)}%</td>
                    <td>${entry.fee_ads.toFixed(2)}%</td>
                </tr>
            `;
            historyTable.insertAdjacentHTML('beforeend', row);
        });

        console.log("Đã hiển thị dữ liệu lên bảng.");
    } catch (error) {
        console.error("Lỗi khi tải lịch sử:", error);
    }
}


// Định nghĩa hàm deleteHistory
   async function deleteHistory() {
    if (!confirm("Bạn có chắc chắn muốn xóa toàn bộ lịch sử?")) return;

    try {
        const response = await fetch(`${API_URL}/history/`, { method: "DELETE" });

        if (response.ok) {
            showNotification("Lịch sử đã được xóa thành công!", "success");
            await fetchHistory();  // Làm mới bảng sau khi xóa
        } else {
            showNotification("Lỗi khi xóa lịch sử.", "error");
        }
    } catch (error) {
        console.error("Lỗi khi xóa lịch sử:", error);
        showNotification("Lỗi kết nối. Vui lòng thử lại.", "error");
    }
}


// Thêm Hàm JavaScript Lưu Lịch Sử
async function saveHistory() {
    console.log("Hàm saveHistory() được gọi");

    const analysisResults = {
        ctr: parseFloat(document.getElementById('ctr-threshold').value) || 2,
        cr: parseFloat(document.getElementById('cr-threshold').value) || 2.5,
        cpp: parseFloat(document.getElementById('cpp-threshold').value) || 10,
        fee_ads: parseFloat(document.getElementById('fee-ads-threshold').value) || 20,
        roi: parseFloat(document.getElementById('roi-threshold').value) || 75
    };

    console.log("Dữ liệu gửi đi:", analysisResults);

    try {
        const response = await fetch(`${API_URL}/history/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(analysisResults)
        });

        if (response.ok) {
            alert("Kết quả đã được lưu!");
            fetchHistory();
        } else {
            const errorData = await response.json();
            throw new Error(`Lỗi khi lưu dữ liệu: ${JSON.stringify(errorData)}`);
        }
    } catch (error) {
        console.error("Lỗi khi lưu dữ liệu:", error);
    }
}

async function getRecommendation(data) {
    try {
        const response = await fetch('/recommend/', {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        console.log("Recommendation from API:", result.recommendation);
        document.getElementById("recommendation-section").innerText = result.recommendation;
    } catch (error) {
        console.error("Lỗi khi gửi yêu cầu:", error);
    }
}


async function renderHistoryChart() {
    const response = await fetch(`${API_URL}/history/`);
    const history = await response.json();

    // Hủy biểu đồ cũ nếu đã tồn tại
    const existingChart = Chart.getChart("historyChart");
    if (existingChart) {
        existingChart.destroy();
    }

    // Lấy dữ liệu từ API
    const labels = history.map(entry => new Date(entry.timestamp).toLocaleString());
    const ctrData = history.map(entry => entry.ctr);
    const crData = history.map(entry => entry.cr);
    const cppData = history.map(entry => entry.cpp);
    const roiData = history.map(entry => entry.roi);

    // Vẽ biểu đồ với nhiều dataset
    const ctx = document.getElementById('historyChart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'CTR (%)',
                    data: ctrData,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderWidth: 1
                },
                {
                    label: 'CR (%)',
                    data: crData,
                    borderColor: 'rgba(255, 99, 132, 1)',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderWidth: 1
                },
                {
                    label: 'CPP (USD)',
                    data: cppData,
                    borderColor: 'rgba(54, 162, 235, 1)',
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderWidth: 1
                },
                {
                    label: 'ROI (%)',
                    data: roiData,
                    borderColor: 'rgba(255, 206, 86, 1)',
                    backgroundColor: 'rgba(255, 206, 86, 0.2)',
                    borderWidth: 1
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                }
            }
        }
    });
}


async function refreshAccessToken() {
    const refreshToken = localStorage.getItem("refreshToken");
    if (!refreshToken) return;

    try {
        const response = await fetch(`${API_URL}/refresh/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ refresh_token: refreshToken })
        });

        if (response.ok) {
            const result = await response.json();
            localStorage.setItem("accessToken", result.access_token);
            showNotification("Token đã được làm mới!", "success");
        } else {
            showNotification("Lỗi khi làm mới token.", "error");
        }
    } catch (error) {
        console.error("Lỗi khi làm mới token:", error);
        showNotification("Lỗi kết nối. Vui lòng thử lại.", "error");
    }
}


async function analyzeData() {

  console.log("Dữ liệu gửi đi từ analyzeData:");
  const data = {
        views: parseInt(document.getElementById('views').value) || 0,
        clicks: parseInt(document.getElementById('clicks').value) || 0,
        orders: parseInt(document.getElementById('orders').value) || 0,
        revenue: parseFloat(document.getElementById('revenue').value) || 0,
        spend: parseFloat(document.getElementById('spend').value) || 0,
        sales: parseFloat(document.getElementById('sales').value) || 0,
        marketing: parseFloat(document.getElementById('marketing').value) || 0,
        fees: parseFloat(document.getElementById('fees').value) || 0,
        thresholds: {
            ctr: parseFloat(document.getElementById('ctr-threshold').value) || 2,
            cr: parseFloat(document.getElementById('cr-threshold').value) || 2.5,
            cpp: parseFloat(document.getElementById('cpp-threshold').value) || 10,
            fee_ads: parseFloat(document.getElementById('fee-ads-threshold').value) || 20,
            roi: parseFloat(document.getElementById('roi-threshold').value) || 75
        }
    };

    console.log("Dữ liệu gửi đi:", data);

    try {
        const response = await fetch('http://127.0.0.1:8000/analyze/', {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        if (!response.ok) {
            console.error(`Lỗi từ backend: ${response.statusText}`);
            alert(`Lỗi từ backend: ${response.statusText}`);
            return;
        }

        const result = await response.json();
        console.log("Kết quả từ backend:", result);
        showNotification("Phân tích dữ liệu thành công!");
       
       // Cập nhật biểu đồ so sánh
       updateChart(result.analysis, data.thresholds);

        // Hiển thị Kết Quả Phân Tích
        const analysisResults = result.analysis;
        if (analysisResults) {
            document.getElementById('analysis-results').innerHTML = `
                <p>CTR: ${analysisResults.ctr.toFixed(2)}%</p>
                <p>CR: ${analysisResults.cr.toFixed(2)}%</p>
                <p>CPP: $${analysisResults.cpp.toFixed(2)}</p>
                <p>ROI: ${analysisResults.roi.toFixed(2)}%</p>
                <p>Fee Ads: ${analysisResults.fee_ads.toFixed(2)}%</p>
            `;
        } else {
            document.getElementById('analysis-results').innerHTML = "<p>Không có dữ liệu phân tích.</p>";
        }

        // Hiển thị đề xuất hành động
       if (result.recommendation) {
    const proposalsHTML = result.recommendation
        .split('<br>')
        .map(proposal => `<p>${proposal.trim()}</p>`)
        .join('');
    document.querySelector('.proposals').innerHTML = proposalsHTML;
} else {
    document.querySelector('.proposals').innerHTML = "<p>Không có đề xuất nào.</p>";
}


        //  Cập nhật biểu đồ
        updateCharts({
            ctr: { current: analysisResults.ctr, average: data.thresholds.ctr },
            cr: { current: analysisResults.cr, average: data.thresholds.cr },
            cpp: { current: analysisResults.cpp, average: data.thresholds.cpp },
            fee_ads: { current: analysisResults.fee_ads, average: data.thresholds.fee_ads },
            roi: { current: analysisResults.roi, average: data.thresholds.roi }
        });

    } catch (error) {
        console.error("Lỗi khi kết nối tới backend:", error);

        if (error.message.includes("Failed to fetch")) {
            alert("Không thể kết nối tới backend. Vui lòng kiểm tra kết nối.");
        } else if (error.message) {
            alert(`Đã xảy ra lỗi: ${error.message}`);
        } else {
            console.error("Lỗi khác:", error);
        }
    }
}




async function saveAnalysis() {
    const data = {
        views: parseInt(document.getElementById('views').value) || 0,
        clicks: parseInt(document.getElementById('clicks').value) || 0,
        orders: parseInt(document.getElementById('orders').value) || 0,
        revenue: parseFloat(document.getElementById('revenue').value) || 0,
        spend: parseFloat(document.getElementById('spend').value) || 0,
        sales: parseFloat(document.getElementById('sales').value) || 0,
        marketing: parseFloat(document.getElementById('marketing').value) || 0,
        fees: parseFloat(document.getElementById('fees').value) || 0
    };

    try {
        const response = await fetch(`${API_URL}/analysis/`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        if (response.ok) {
            alert("Dữ liệu đã được lưu thành công!");
        } else {
            alert("Lỗi khi lưu dữ liệu.");
        }

    } catch (error) {
        console.error("Lỗi lưu dữ liệu:", error);
    }
}


// Hàm vẽ biểu đồ

function renderChart(canvasId, label, data, backgroundColor) {
    const canvas = document.getElementById(canvasId);
    if (!canvas) {
        console.error(`Không tìm thấy phần tử canvas với ID: ${canvasId}`);
        return;
    }

    const ctx = canvas.getContext('2d');

    // Phá hủy biểu đồ cũ nếu tồn tại
    if (charts[canvasId]) {
        charts[canvasId].destroy();
    }

    // Tạo biểu đồ mới và lưu vào charts
    charts[canvasId] = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Hiện tại', 'Ngưỡng Trung Bình'],
            datasets: [{
                label: label,
                data: data,
                backgroundColor: backgroundColor,
            }],
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'top' },
                title: { display: true, text: `So Sánh ${label}` },
            },
        },
    });
}

function updateChart(currentData, averageData) {
    const canvas = document.getElementById("comparison-chart");
    if (!canvas) {
        console.error("Không tìm thấy phần tử canvas.");
        return;
    }

    const ctx = canvas.getContext("2d");

    // Phá hủy biểu đồ cũ nếu tồn tại
    if (comparisonChart) {
        comparisonChart.destroy();
    }

    // Tạo biểu đồ mới với dữ liệu ngưỡng tùy chỉnh
    comparisonChart = new Chart(ctx, {
        type: "bar",
        data: {
            labels: ["CTR", "CR", "CPP", "ROI", "Fee Ads"],
            datasets: [
                {
                    label: "Hiện Tại",
                    data: [currentData.ctr, currentData.cr, currentData.cpp, currentData.roi, currentData.fee_ads],
                    backgroundColor: "rgba(75, 192, 192, 0.6)",
                    borderColor: "rgba(75, 192, 192, 1)",
                    borderWidth: 1
                },
                {
                    label: "Ngưỡng Trung Bình",
                    data: [averageData.ctr, averageData.cr, averageData.cpp, averageData.roi, averageData.fee_ads],
                    backgroundColor: "rgba(153, 102, 255, 0.6)",
                    borderColor: "rgba(153, 102, 255, 1)",
                    borderWidth: 1
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: "top" },
                title: { display: true, text: "So Sánh Chỉ Số Bán hàng Hiện tại và Ngưỡng Trung Bình Của Bạn" }
            }
        }
    });
}


     // Cập nhật các biểu đồ tại đây
    function updateCharts(chartsData) {
    document.querySelector('.section-header').innerText = 'So Sánh Chỉ Số';
    // Kiểm tra dữ liệu truyền vào
    console.log("Dữ liệu biểu đồ:", chartsData);

    renderChart('chart-ctr', 'CTR (%)', [chartsData.ctr.current, chartsData.ctr.average], ['#4CAF50', '#FF5722']);
    renderChart('chart-cr', 'CR (%)', [chartsData.cr.current, chartsData.cr.average], ['#2196F3', '#FFC107']);
    renderChart('chart-cpp', 'CPP (USD)', [chartsData.cpp.current, chartsData.cpp.average], ['#9C27B0', '#3F51B5']);
    renderChart('chart-roi', 'ROI (%)', [chartsData.roi.current, chartsData.roi.average], ['#E91E63', '#03A9F4']);
    renderChart('chart-fee', 'Fee Ads (%)', [chartsData.fee_ads.current, chartsData.fee_ads.average], ['#03A9F4', '#FFC107']);


// Hàm gọi backend và hiển thị biểu đồ
// Cập nhật hiển thị kết quả phân tích

    }

function toggleRegisterForm() {
    // Ẩn form đăng nhập
    document.getElementById("login-section").style.display = "none";

    // Hiển thị form đăng ký
    document.getElementById("register-section").style.display = "block";
}

function toggleLoginForm() {
    // Ẩn form đăng ký
    document.getElementById("register-section").style.display = "none";

    // Hiển thị lại form đăng nhập
    document.getElementById("login-section").style.display = "block";
}

// Hàm chuyển đổi giữa các form
function toggleForgotPasswordForm() {
    document.getElementById("login-section").style.display = "none";
    document.getElementById("forgot-password-section").style.display = "block";
}

async function loginUser() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!email || !password) {
        alert("Vui lòng nhập email và mật khẩu!");
        return;
    }

    const payload = { email: email, password: password };

    console.log("📡 Gửi yêu cầu đăng nhập...", payload);

    try {
        const response = await fetch("http://127.0.0.1:8000/etsyads/login/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },  // ✅ Đảm bảo gửi JSON
            body: JSON.stringify(payload)  // ✅ Đảm bảo đúng định dạng JSON
        });

        const result = await response.json();
        console.log("📩 Phản hồi từ server:", result);

        if (response.ok) {
            alert("✅ Đăng nhập thành công!");
            window.location.href = "/static/etsyadsAI.html";  // Chuyển hướng đến trang chính
        } else {
            alert(`❌ Lỗi đăng nhập: ${result.detail || "Không thể đăng nhập."}`);
        }
    } catch (error) {
        console.error("❌ Lỗi khi đăng nhập:", error);
        alert("Đã xảy ra lỗi, vui lòng thử lại.");
    }
}


</script>
<!-- Chèn JavaScript từ thư mục static -->
<script src="static/script.js"></script>

<!-- Footer -->
    <footer style="text-align: center; margin-top: 20px;">
        <p>© 2025 LeLifeAI. All rights reserved.</p>
    </footer>
</body>
</html>
